char *
sip_get_callid(const char* payload, char *callid)
{
    regmatch_t pmatch[3];

    // Try to get Call-ID from payload
    if (regexec(&calls.reg_callid, payload, 3, pmatch, 0) == 0) {
        int input_len = pmatch[2].rm_eo - pmatch[2].rm_so;

        // Ensure the copy length does not exceed MAX_CALLID_SIZE - 1
        if (input_len > MAX_CALLID_SIZE - 1) {
            input_len = MAX_CALLID_SIZE - 1;
        }

        // Copy the matching part of payload
        strncpy(callid, payload + pmatch[2].rm_so, input_len);
        callid[input_len] = '\0';
    }

    return callid;
}
