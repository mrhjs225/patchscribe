unit [0,0]
    macro [0,126]
        name: nf_nat_redirect_ipv4 [0,20]
        argument_list [20,126]
            argument [21,40]
            argument [49,96]
            argument [105,125]
    block [127,1297]
        block_content [130,1295]
            decl_stmt [130,149]
                decl [130,148]
                    type [130,146]
                        name [130,144]
                            name: struct [130,136]
                            name: nf_conn [137,144]
                        modifier: * [145,146]
                    name: ct [146,148]
            decl_stmt [151,181]
                decl [151,180]
                    type [151,173]
                        name [151,173]
                            name: enum [151,155]
                            name: ip_conntrack_info [156,173]
                    name: ctinfo [174,180]
            decl_stmt [183,197]
                decl [183,196]
                    type [183,189]
                        name: __be32 [183,189]
                    name: newdst [190,196]
            decl_stmt [199,228]
                decl [199,227]
                    type [199,218]
                        name [199,218]
                            name: struct [199,205]
                            name: nf_nat_range [206,218]
                    name: newrange [219,227]
            expr_stmt [231,315]
                expr [231,314]
                    call [231,314]
                        name: NF_CT_ASSERT [231,243]
                        argument_list [243,314]
                            argument [244,313]
                                expr [244,313]
                                    name: hooknum [244,251]
                                    operator: == [252,254]
                                    name: NF_INET_PRE_ROUTING [255,274]
                                    operator: || [275,277]
                                    name: hooknum [285,292]
                                    operator: == [293,295]
                                    name: NF_INET_LOCAL_OUT [296,313]
            expr_stmt [318,347]
                expr [318,346]
                    name: ct [318,320]
                    operator: = [321,322]
                    call [323,346]
                        name: nf_ct_get [323,332]
                        argument_list [332,346]
                            argument [333,336]
                                expr [333,336]
                                    name: skb [333,336]
                            argument [338,345]
                                expr [338,345]
                                    operator: & [338,339]
                                    name: ctinfo [339,345]
            expr_stmt [349,418]
                expr [349,417]
                    call [349,417]
                        name: NF_CT_ASSERT [349,361]
                        argument_list [361,417]
                            argument [362,416]
                                expr [362,416]
                                    name: ct [362,364]
                                    operator: && [365,367]
                                    operator: ( [368,369]
                                    name: ctinfo [369,375]
                                    operator: == [376,378]
                                    name: IP_CT_NEW [379,388]
                                    operator: || [389,391]
                                    name: ctinfo [392,398]
                                    operator: == [399,401]
                                    name: IP_CT_RELATED [402,415]
                                    operator: ) [415,416]
            comment: /* Local packets: make them go to loopback */ [421,466]
            if_stmt [468,819]
                if [468,536]
                    condition [471,501]
                        expr [472,500]
                            name: hooknum [472,479]
                            operator: == [480,482]
                            name: NF_INET_LOCAL_OUT [483,500]
                    block [502,536]
                        block_content [506,533]
                            expr_stmt [506,533]
                                expr [506,532]
                                    name: newdst [506,512]
                                    operator: = [513,514]
                                    call [515,532]
                                        name: htonl [515,520]
                                        argument_list [520,532]
                                            argument [521,531]
                                                expr [521,531]
                                                    literal: 0x7F000001 [521,531]
                else [537,819]
                    block [542,819]
                        block_content [546,816]
                            decl_stmt [546,570]
                                decl [546,569]
                                    type [546,564]
                                        name [546,562]
                                            name: struct [546,552]
                                            name: in_device [553,562]
                                        modifier: * [563,564]
                                    name: indev [564,569]
                            decl_stmt [573,595]
                                decl [573,594]
                                    type [573,591]
                                        name [573,589]
                                            name: struct [573,579]
                                            name: in_ifaddr [580,589]
                                        modifier: * [590,591]
                                    name: ifa [591,594]
                            expr_stmt [599,610]
                                expr [599,609]
                                    name: newdst [599,605]
                                    operator: = [606,607]
                                    literal: 0 [608,609]
                            expr_stmt [614,630]
                                expr [614,629]
                                    call [614,629]
                                        name: rcu_read_lock [614,627]
                                        argument_list [627,629]
                            expr_stmt [633,668]
                                expr [633,667]
                                    name: indev [633,638]
                                    operator: = [639,640]
                                    call [641,667]
                                        name: __in_dev_get_rcu [641,657]
                                        argument_list [657,667]
                                            argument [658,666]
                                                expr [658,666]
                                                    name [658,666]
                                                        name: skb [658,661]
                                                        operator: -> [661,663]
                                                        name: dev [663,666]
                            if_stmt [671,760]
                                if [671,760]
                                    condition [674,700]
                                        expr [675,699]
                                            name: indev [675,680]
                                            operator: && [681,683]
                                            name [684,699]
                                                name: indev [684,689]
                                                operator: -> [689,691]
                                                name: ifa_list [691,699]
                                    block [701,760]
                                        block_content [706,756]
                                            expr_stmt [706,728]
                                                expr [706,727]
                                                    name: ifa [706,709]
                                                    operator: = [710,711]
                                                    name [712,727]
                                                        name: indev [712,717]
                                                        operator: -> [717,719]
                                                        name: ifa_list [719,727]
                                            expr_stmt [732,756]
                                                expr [732,755]
                                                    name: newdst [732,738]
                                                    operator: = [739,740]
                                                    name [741,755]
                                                        name: ifa [741,744]
                                                        operator: -> [744,746]
                                                        name: ifa_local [746,755]
                            expr_stmt [763,781]
                                expr [763,780]
                                    call [763,780]
                                        name: rcu_read_unlock [763,778]
                                        argument_list [778,780]
                            if_stmt [785,816]
                                if [785,816]
                                    condition [788,797]
                                        expr [789,796]
                                            operator: ! [789,790]
                                            name: newdst [790,796]
                                    block [801,816]
                                        block_content [801,816]
                                            return [801,816]
                                                expr [808,815]
                                                    name: NF_DROP [808,815]
            comment: /* Transfer from original range. */ [822,857]
            expr_stmt [859,916]
                expr [859,915]
                    call [859,915]
                        name: memset [859,865]
                        argument_list [865,915]
                            argument [866,884]
                                expr [866,884]
                                    operator: & [866,867]
                                    name [867,884]
                                        name: newrange [867,875]
                                        operator: . [875,876]
                                        name: min_addr [876,884]
                            argument [886,887]
                                expr [886,887]
                                    literal: 0 [886,887]
                            argument [889,914]
                                expr [889,914]
                                    sizeof [889,914]
                                        argument_list [895,914]
                                            argument [896,913]
                                                expr [896,913]
                                                    name [896,913]
                                                        name: newrange [896,904]
                                                        operator: . [904,905]
                                                        name: min_addr [905,913]
            expr_stmt [918,975]
                expr [918,974]
                    call [918,974]
                        name: memset [918,924]
                        argument_list [924,974]
                            argument [925,943]
                                expr [925,943]
                                    operator: & [925,926]
                                    name [926,943]
                                        name: newrange [926,934]
                                        operator: . [934,935]
                                        name: max_addr [935,943]
                            argument [945,946]
                                expr [945,946]
                                    literal: 0 [945,946]
                            argument [948,973]
                                expr [948,973]
                                    sizeof [948,973]
                                        argument_list [954,973]
                                            argument [955,972]
                                                expr [955,972]
                                                    name [955,972]
                                                        name: newrange [955,963]
                                                        operator: . [963,964]
                                                        name: max_addr [964,972]
            expr_stmt [977,1041]
                expr [977,1040]
                    name [977,991]
                        name: newrange [977,985]
                        operator: . [985,986]
                        name: flags [986,991]
                    operator: = [997,998]
                    name [999,1011]
                        name: mr [999,1001]
                        operator: -> [1001,1003]
                        name: range [1003,1008]
                        index [1008,1011]
                            expr [1009,1010]
                                literal: 0 [1009,1010]
                    operator: . [1011,1012]
                    name: flags [1012,1017]
                    operator: | [1018,1019]
                    name: NF_NAT_RANGE_MAP_IPS [1020,1040]
            expr_stmt [1043,1073]
                expr [1043,1072]
                    name [1043,1063]
                        name: newrange [1043,1051]
                        operator: . [1051,1052]
                        name: min_addr [1052,1060]
                        operator: . [1060,1061]
                        name: ip [1061,1063]
                    operator: = [1064,1065]
                    name: newdst [1066,1072]
            expr_stmt [1075,1105]
                expr [1075,1104]
                    name [1075,1095]
                        name: newrange [1075,1083]
                        operator: . [1083,1084]
                        name: max_addr [1084,1092]
                        operator: . [1092,1093]
                        name: ip [1093,1095]
                    operator: = [1096,1097]
                    name: newdst [1098,1104]
            expr_stmt [1107,1147]
                expr [1107,1146]
                    name [1107,1125]
                        name: newrange [1107,1115]
                        operator: . [1115,1116]
                        name: min_proto [1116,1125]
                    operator: = [1128,1129]
                    name [1130,1142]
                        name: mr [1130,1132]
                        operator: -> [1132,1134]
                        name: range [1134,1139]
                        index [1139,1142]
                            expr [1140,1141]
                                literal: 0 [1140,1141]
                    operator: . [1142,1143]
                    name: min [1143,1146]
            expr_stmt [1149,1189]
                expr [1149,1188]
                    name [1149,1167]
                        name: newrange [1149,1157]
                        operator: . [1157,1158]
                        name: max_proto [1158,1167]
                    operator: = [1170,1171]
                    name [1172,1184]
                        name: mr [1172,1174]
                        operator: -> [1174,1176]
                        name: range [1176,1181]
                        index [1181,1184]
                            expr [1182,1183]
                                literal: 0 [1182,1183]
                    operator: . [1184,1185]
                    name: max [1185,1188]
            comment: /* Hand modified range to generic setup. */ [1192,1235]
            return [1237,1295]
                expr [1244,1294]
                    call [1244,1294]
                        name: nf_nat_setup_info [1244,1261]
                        argument_list [1261,1294]
                            argument [1262,1264]
                                expr [1262,1264]
                                    name: ct [1262,1264]
                            argument [1266,1275]
                                expr [1266,1275]
                                    operator: & [1266,1267]
                                    name: newrange [1267,1275]
                            argument [1277,1293]
                                expr [1277,1293]
                                    name: NF_NAT_MANIP_DST [1277,1293]