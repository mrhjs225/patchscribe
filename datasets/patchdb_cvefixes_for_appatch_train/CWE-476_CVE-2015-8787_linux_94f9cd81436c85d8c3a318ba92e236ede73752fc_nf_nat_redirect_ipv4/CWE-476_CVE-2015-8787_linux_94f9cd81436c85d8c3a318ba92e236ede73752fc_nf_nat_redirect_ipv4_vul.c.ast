unit [0,0]
    macro [0,126]
        name: nf_nat_redirect_ipv4 [0,20]
        argument_list [20,126]
            argument [21,40]
            argument [49,96]
            argument [105,125]
    block [127,1286]
        block_content [130,1284]
            decl_stmt [130,149]
                decl [130,148]
                    type [130,146]
                        name [130,144]
                            name: struct [130,136]
                            name: nf_conn [137,144]
                        modifier: * [145,146]
                    name: ct [146,148]
            decl_stmt [151,181]
                decl [151,180]
                    type [151,173]
                        name [151,173]
                            name: enum [151,155]
                            name: ip_conntrack_info [156,173]
                    name: ctinfo [174,180]
            decl_stmt [183,197]
                decl [183,196]
                    type [183,189]
                        name: __be32 [183,189]
                    name: newdst [190,196]
            decl_stmt [199,228]
                decl [199,227]
                    type [199,218]
                        name [199,218]
                            name: struct [199,205]
                            name: nf_nat_range [206,218]
                    name: newrange [219,227]
            expr_stmt [231,315]
                expr [231,314]
                    call [231,314]
                        name: NF_CT_ASSERT [231,243]
                        argument_list [243,314]
                            argument [244,313]
                                expr [244,313]
                                    name: hooknum [244,251]
                                    operator: == [252,254]
                                    name: NF_INET_PRE_ROUTING [255,274]
                                    operator: || [275,277]
                                    name: hooknum [285,292]
                                    operator: == [293,295]
                                    name: NF_INET_LOCAL_OUT [296,313]
            expr_stmt [318,347]
                expr [318,346]
                    name: ct [318,320]
                    operator: = [321,322]
                    call [323,346]
                        name: nf_ct_get [323,332]
                        argument_list [332,346]
                            argument [333,336]
                                expr [333,336]
                                    name: skb [333,336]
                            argument [338,345]
                                expr [338,345]
                                    operator: & [338,339]
                                    name: ctinfo [339,345]
            expr_stmt [349,418]
                expr [349,417]
                    call [349,417]
                        name: NF_CT_ASSERT [349,361]
                        argument_list [361,417]
                            argument [362,416]
                                expr [362,416]
                                    name: ct [362,364]
                                    operator: && [365,367]
                                    operator: ( [368,369]
                                    name: ctinfo [369,375]
                                    operator: == [376,378]
                                    name: IP_CT_NEW [379,388]
                                    operator: || [389,391]
                                    name: ctinfo [392,398]
                                    operator: == [399,401]
                                    name: IP_CT_RELATED [402,415]
                                    operator: ) [415,416]
            comment: /* Local packets: make them go to loopback */ [421,466]
            if_stmt [468,808]
                if [468,536]
                    condition [471,501]
                        expr [472,500]
                            name: hooknum [472,479]
                            operator: == [480,482]
                            name: NF_INET_LOCAL_OUT [483,500]
                    block [502,536]
                        block_content [506,533]
                            expr_stmt [506,533]
                                expr [506,532]
                                    name: newdst [506,512]
                                    operator: = [513,514]
                                    call [515,532]
                                        name: htonl [515,520]
                                        argument_list [520,532]
                                            argument [521,531]
                                                expr [521,531]
                                                    literal: 0x7F000001 [521,531]
                else [537,808]
                    block [542,808]
                        block_content [546,805]
                            decl_stmt [546,570]
                                decl [546,569]
                                    type [546,564]
                                        name [546,562]
                                            name: struct [546,552]
                                            name: in_device [553,562]
                                        modifier: * [563,564]
                                    name: indev [564,569]
                            decl_stmt [573,595]
                                decl [573,594]
                                    type [573,591]
                                        name [573,589]
                                            name: struct [573,579]
                                            name: in_ifaddr [580,589]
                                        modifier: * [590,591]
                                    name: ifa [591,594]
                            expr_stmt [599,610]
                                expr [599,609]
                                    name: newdst [599,605]
                                    operator: = [606,607]
                                    literal: 0 [608,609]
                            expr_stmt [614,630]
                                expr [614,629]
                                    call [614,629]
                                        name: rcu_read_lock [614,627]
                                        argument_list [627,629]
                            expr_stmt [633,668]
                                expr [633,667]
                                    name: indev [633,638]
                                    operator: = [639,640]
                                    call [641,667]
                                        name: __in_dev_get_rcu [641,657]
                                        argument_list [657,667]
                                            argument [658,666]
                                                expr [658,666]
                                                    name [658,666]
                                                        name: skb [658,661]
                                                        operator: -> [661,663]
                                                        name: dev [663,666]
                            if_stmt [671,749]
                                if [671,749]
                                    condition [674,689]
                                        expr [675,688]
                                            name: indev [675,680]
                                            operator: != [681,683]
                                            name: NULL [684,688]
                                    block [690,749]
                                        block_content [695,745]
                                            expr_stmt [695,717]
                                                expr [695,716]
                                                    name: ifa [695,698]
                                                    operator: = [699,700]
                                                    name [701,716]
                                                        name: indev [701,706]
                                                        operator: -> [706,708]
                                                        name: ifa_list [708,716]
                                            expr_stmt [721,745]
                                                expr [721,744]
                                                    name: newdst [721,727]
                                                    operator: = [728,729]
                                                    name [730,744]
                                                        name: ifa [730,733]
                                                        operator: -> [733,735]
                                                        name: ifa_local [735,744]
                            expr_stmt [752,770]
                                expr [752,769]
                                    call [752,769]
                                        name: rcu_read_unlock [752,767]
                                        argument_list [767,769]
                            if_stmt [774,805]
                                if [774,805]
                                    condition [777,786]
                                        expr [778,785]
                                            operator: ! [778,779]
                                            name: newdst [779,785]
                                    block [790,805]
                                        block_content [790,805]
                                            return [790,805]
                                                expr [797,804]
                                                    name: NF_DROP [797,804]
            comment: /* Transfer from original range. */ [811,846]
            expr_stmt [848,905]
                expr [848,904]
                    call [848,904]
                        name: memset [848,854]
                        argument_list [854,904]
                            argument [855,873]
                                expr [855,873]
                                    operator: & [855,856]
                                    name [856,873]
                                        name: newrange [856,864]
                                        operator: . [864,865]
                                        name: min_addr [865,873]
                            argument [875,876]
                                expr [875,876]
                                    literal: 0 [875,876]
                            argument [878,903]
                                expr [878,903]
                                    sizeof [878,903]
                                        argument_list [884,903]
                                            argument [885,902]
                                                expr [885,902]
                                                    name [885,902]
                                                        name: newrange [885,893]
                                                        operator: . [893,894]
                                                        name: min_addr [894,902]
            expr_stmt [907,964]
                expr [907,963]
                    call [907,963]
                        name: memset [907,913]
                        argument_list [913,963]
                            argument [914,932]
                                expr [914,932]
                                    operator: & [914,915]
                                    name [915,932]
                                        name: newrange [915,923]
                                        operator: . [923,924]
                                        name: max_addr [924,932]
                            argument [934,935]
                                expr [934,935]
                                    literal: 0 [934,935]
                            argument [937,962]
                                expr [937,962]
                                    sizeof [937,962]
                                        argument_list [943,962]
                                            argument [944,961]
                                                expr [944,961]
                                                    name [944,961]
                                                        name: newrange [944,952]
                                                        operator: . [952,953]
                                                        name: max_addr [953,961]
            expr_stmt [966,1030]
                expr [966,1029]
                    name [966,980]
                        name: newrange [966,974]
                        operator: . [974,975]
                        name: flags [975,980]
                    operator: = [986,987]
                    name [988,1000]
                        name: mr [988,990]
                        operator: -> [990,992]
                        name: range [992,997]
                        index [997,1000]
                            expr [998,999]
                                literal: 0 [998,999]
                    operator: . [1000,1001]
                    name: flags [1001,1006]
                    operator: | [1007,1008]
                    name: NF_NAT_RANGE_MAP_IPS [1009,1029]
            expr_stmt [1032,1062]
                expr [1032,1061]
                    name [1032,1052]
                        name: newrange [1032,1040]
                        operator: . [1040,1041]
                        name: min_addr [1041,1049]
                        operator: . [1049,1050]
                        name: ip [1050,1052]
                    operator: = [1053,1054]
                    name: newdst [1055,1061]
            expr_stmt [1064,1094]
                expr [1064,1093]
                    name [1064,1084]
                        name: newrange [1064,1072]
                        operator: . [1072,1073]
                        name: max_addr [1073,1081]
                        operator: . [1081,1082]
                        name: ip [1082,1084]
                    operator: = [1085,1086]
                    name: newdst [1087,1093]
            expr_stmt [1096,1136]
                expr [1096,1135]
                    name [1096,1114]
                        name: newrange [1096,1104]
                        operator: . [1104,1105]
                        name: min_proto [1105,1114]
                    operator: = [1117,1118]
                    name [1119,1131]
                        name: mr [1119,1121]
                        operator: -> [1121,1123]
                        name: range [1123,1128]
                        index [1128,1131]
                            expr [1129,1130]
                                literal: 0 [1129,1130]
                    operator: . [1131,1132]
                    name: min [1132,1135]
            expr_stmt [1138,1178]
                expr [1138,1177]
                    name [1138,1156]
                        name: newrange [1138,1146]
                        operator: . [1146,1147]
                        name: max_proto [1147,1156]
                    operator: = [1159,1160]
                    name [1161,1173]
                        name: mr [1161,1163]
                        operator: -> [1163,1165]
                        name: range [1165,1170]
                        index [1170,1173]
                            expr [1171,1172]
                                literal: 0 [1171,1172]
                    operator: . [1173,1174]
                    name: max [1174,1177]
            comment: /* Hand modified range to generic setup. */ [1181,1224]
            return [1226,1284]
                expr [1233,1283]
                    call [1233,1283]
                        name: nf_nat_setup_info [1233,1250]
                        argument_list [1250,1283]
                            argument [1251,1253]
                                expr [1251,1253]
                                    name: ct [1251,1253]
                            argument [1255,1264]
                                expr [1255,1264]
                                    operator: & [1255,1256]
                                    name: newrange [1256,1264]
                            argument [1266,1282]
                                expr [1266,1282]
                                    name: NF_NAT_MANIP_DST [1266,1282]