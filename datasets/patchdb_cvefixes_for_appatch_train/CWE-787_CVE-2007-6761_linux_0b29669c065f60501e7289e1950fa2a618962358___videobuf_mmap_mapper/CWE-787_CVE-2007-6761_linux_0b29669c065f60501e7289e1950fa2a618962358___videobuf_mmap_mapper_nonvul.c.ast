unit [0,0]
    function [0,1746]
        type [0,10]
            specifier: static [0,6]
            name: int [7,10]
        name: __videobuf_mmap_mapper [11,33]
        parameter_list [33,91]
            parameter [34,58]
                decl [34,58]
                    type [34,58]
                        name [34,55]
                            name: struct [34,40]
                            name: videobuf_queue [41,55]
                        modifier: * [56,57]
                    name: q [57,58]
            parameter [64,90]
                decl [64,90]
                    type [64,90]
                        name [64,85]
                            name: struct [64,70]
                            name: vm_area_struct [71,85]
                        modifier: * [86,87]
                    name: vma [87,90]
        block [92,1746]
            block_content [95,1744]
                decl_stmt [95,130]
                    decl [95,129]
                        type [95,126]
                            name [95,124]
                                name: struct [95,101]
                                name: videbuf_vmalloc_memory [102,124]
                            modifier: * [125,126]
                        name: mem [126,129]
                decl_stmt [132,161]
                    decl [132,160]
                        type [132,157]
                            name [132,155]
                                name: struct [132,138]
                                name: videobuf_mapping [139,155]
                            modifier: * [156,157]
                        name: map [157,160]
                decl_stmt [163,182]
                    decl [163,181]
                        type [163,175]
                            name: unsigned [163,171]
                            name: int [172,175]
                        name: first [176,181]
                decl_stmt [184,195]
                    decl [184,194]
                        type [184,187]
                            name: int [184,187]
                        name: retval [188,194]
                decl_stmt [197,248]
                    decl [197,247]
                        type [197,210]
                            name: unsigned [197,205]
                            name: long [206,210]
                        name: offset [211,217]
                        init [218,247]
                            expr [220,247]
                                name [220,233]
                                    name: vma [220,223]
                                    operator: -> [223,225]
                                    name: vm_pgoff [225,233]
                                operator: << [234,236]
                                name: PAGE_SHIFT [237,247]
                if_stmt [251,335]
                    if [251,335]
                        condition [254,317]
                            expr [255,316]
                                operator: ! [255,256]
                                operator: ( [257,258]
                                name [258,271]
                                    name: vma [258,261]
                                    operator: -> [261,263]
                                    name: vm_flags [263,271]
                                operator: & [272,273]
                                name: VM_WRITE [274,282]
                                operator: ) [282,283]
                                operator: || [284,286]
                                operator: ! [287,288]
                                operator: ( [289,290]
                                name [290,303]
                                    name: vma [290,293]
                                    operator: -> [293,295]
                                    name: vm_flags [295,303]
                                operator: & [304,305]
                                name: VM_SHARED [306,315]
                                operator: ) [315,316]
                        block [320,335]
                            block_content [320,335]
                                return [320,335]
                                    expr [327,334]
                                        operator: - [327,328]
                                        name: EINVAL [328,334]
                comment: /* look for first buffer to map */ [338,372]
                for [374,583]
                    control [378,423]
                        init [379,389]
                            expr [379,388]
                                name: first [379,384]
                                operator: = [385,386]
                                literal: 0 [387,388]
                        condition [390,414]
                            expr [390,413]
                                name: first [390,395]
                                operator: < [396,397]
                                name: VIDEO_MAX_FRAME [398,413]
                        incr [415,422]
                            expr [415,422]
                                name: first [415,420]
                                operator: ++ [420,422]
                    block [424,583]
                        block_content [428,580]
                            if_stmt [428,468]
                                if [428,468]
                                    condition [431,455]
                                        expr [432,454]
                                            name: NULL [432,436]
                                            operator: == [437,439]
                                            name [440,454]
                                                name: q [440,441]
                                                operator: -> [441,443]
                                                name: bufs [443,447]
                                                index [447,454]
                                                    expr [448,453]
                                                        name: first [448,453]
                                    block [459,468]
                                        block_content [459,468]
                                            continue [459,468]
                            if_stmt [472,532]
                                if [472,532]
                                    condition [475,519]
                                        expr [476,518]
                                            name: V4L2_MEMORY_MMAP [476,492]
                                            operator: != [493,495]
                                            name [496,510]
                                                name: q [496,497]
                                                operator: -> [497,499]
                                                name: bufs [499,503]
                                                index [503,510]
                                                    expr [504,509]
                                                        name: first [504,509]
                                            operator: -> [510,512]
                                            name: memory [512,518]
                                    block [523,532]
                                        block_content [523,532]
                                            continue [523,532]
                            if_stmt [535,580]
                                if [535,580]
                                    condition [538,570]
                                        expr [539,569]
                                            name [539,553]
                                                name: q [539,540]
                                                operator: -> [540,542]
                                                name: bufs [542,546]
                                                index [546,553]
                                                    expr [547,552]
                                                        name: first [547,552]
                                            operator: -> [553,555]
                                            name: boff [555,559]
                                            operator: == [560,562]
                                            name: offset [563,569]
                                    block [574,580]
                                        block_content [574,580]
                                            break [574,580]
                if_stmt [585,733]
                    if [585,733]
                        condition [588,614]
                            expr [589,613]
                                name: VIDEO_MAX_FRAME [589,604]
                                operator: == [605,607]
                                name: first [608,613]
                        block [615,733]
                            block_content [619,730]
                                expr_stmt [619,712]
                                    expr [619,711]
                                        call [619,711]
                                            name: dprintk [619,626]
                                            argument_list [626,711]
                                                argument [627,628]
                                                    expr [627,628]
                                                        literal: 1 [627,628]
                                                argument [629,676]
                                                    expr [629,676]
                                                        literal: "mmap app bug: offset invalid [offset=0x%lx]\n" [629,676]
                                                argument [681,710]
                                                    expr [681,710]
                                                        operator: ( [681,682]
                                                        name [682,695]
                                                            name: vma [682,685]
                                                            operator: -> [685,687]
                                                            name: vm_pgoff [687,695]
                                                        operator: << [696,698]
                                                        name: PAGE_SHIFT [699,709]
                                                        operator: ) [709,710]
                                return [715,730]
                                    expr [722,729]
                                        operator: - [722,723]
                                        name: EINVAL [723,729]
                comment: /* create mapping + update buffer list */ [736,777]
                expr_stmt [779,859]
                    expr [779,858]
                        name: map [779,782]
                        operator: = [783,784]
                        name [785,799]
                            name: q [785,786]
                            operator: -> [786,788]
                            name: bufs [788,792]
                            index [792,799]
                                expr [793,798]
                                    name: first [793,798]
                        operator: -> [799,801]
                        name: map [801,804]
                        operator: = [805,806]
                        call [807,858]
                            name: kzalloc [807,814]
                            argument_list [814,858]
                                argument [815,846]
                                    expr [815,846]
                                        sizeof [815,846]
                                            argument_list [821,846]
                                                argument [822,845]
                                                    expr [822,845]
                                                        name: videobuf_mapping [829,845]
                                argument [847,857]
                                    expr [847,857]
                                        name: GFP_KERNEL [847,857]
                if_stmt [861,895]
                    if [861,895]
                        condition [864,877]
                            expr [865,876]
                                name: NULL [865,869]
                                operator: == [870,872]
                                name: map [873,876]
                        block [880,895]
                            block_content [880,895]
                                return [880,895]
                                    expr [887,894]
                                        operator: - [887,888]
                                        name: ENOMEM [888,894]
                expr_stmt [898,925]
                    expr [898,924]
                        name [898,908]
                            name: map [898,901]
                            operator: -> [901,903]
                            name: start [903,908]
                        operator: = [909,910]
                        name [911,924]
                            name: vma [911,914]
                            operator: -> [914,916]
                            name: vm_start [916,924]
                expr_stmt [927,952]
                    expr [927,951]
                        name [927,935]
                            name: map [927,930]
                            operator: -> [930,932]
                            name: end [932,935]
                        operator: = [938,939]
                        name [940,951]
                            name: vma [940,943]
                            operator: -> [943,945]
                            name: vm_end [945,951]
                expr_stmt [954,969]
                    expr [954,968]
                        name [954,960]
                            name: map [954,957]
                            operator: -> [957,959]
                            name: q [959,960]
                        operator: = [965,966]
                        name: q [967,968]
                expr_stmt [972,1010]
                    expr [972,1009]
                        name [972,986]
                            name: q [972,973]
                            operator: -> [973,975]
                            name: bufs [975,979]
                            index [979,986]
                                expr [980,985]
                                    name: first [980,985]
                        operator: -> [986,988]
                        name: baddr [988,993]
                        operator: = [994,995]
                        name [996,1009]
                            name: vma [996,999]
                            operator: -> [999,1001]
                            name: vm_start [1001,1009]
                expr_stmt [1013,1053]
                    expr [1013,1052]
                        name [1013,1024]
                            name: vma [1013,1016]
                            operator: -> [1016,1018]
                            name: vm_ops [1018,1024]
                        operator: = [1034,1035]
                        operator: & [1036,1037]
                        name: videobuf_vm_ops [1037,1052]
                expr_stmt [1055,1106]
                    expr [1055,1105]
                        name [1055,1068]
                            name: vma [1055,1058]
                            operator: -> [1058,1060]
                            name: vm_flags [1060,1068]
                        operator: |= [1075,1077]
                        name: VM_DONTEXPAND [1078,1091]
                        operator: | [1092,1093]
                        name: VM_RESERVED [1094,1105]
                expr_stmt [1108,1135]
                    expr [1108,1134]
                        name [1108,1128]
                            name: vma [1108,1111]
                            operator: -> [1111,1113]
                            name: vm_private_data [1113,1128]
                        operator: = [1129,1130]
                        name: map [1131,1134]
                expr_stmt [1138,1163]
                    expr [1138,1162]
                        name: mem [1138,1141]
                        operator: = [1141,1142]
                        name [1142,1156]
                            name: q [1142,1143]
                            operator: -> [1143,1145]
                            name: bufs [1145,1149]
                            index [1149,1156]
                                expr [1150,1155]
                                    name: first [1150,1155]
                        operator: -> [1156,1158]
                        name: priv [1158,1162]
                expr_stmt [1165,1179]
                    expr [1165,1178]
                        call [1165,1178]
                            name: BUG_ON [1165,1171]
                            argument_list [1172,1178]
                                argument [1173,1177]
                                    expr [1173,1177]
                                        operator: ! [1173,1174]
                                        name: mem [1174,1177]
                expr_stmt [1181,1220]
                    expr [1181,1219]
                        call [1181,1219]
                            name: MAGIC_CHECK [1181,1192]
                            argument_list [1192,1219]
                                argument [1193,1203]
                                    expr [1193,1203]
                                        name [1193,1203]
                                            name: mem [1193,1196]
                                            operator: -> [1196,1198]
                                            name: magic [1198,1203]
                                argument [1204,1218]
                                    expr [1204,1218]
                                        name: MAGIC_VMAL_MEM [1204,1218]
                comment: /* Try to remap memory */ [1223,1248]
                expr_stmt [1250,1298]
                    expr [1250,1297]
                        name: retval [1250,1256]
                        operator: = [1256,1257]
                        call [1257,1297]
                            name: remap_vmalloc_range [1257,1276]
                            argument_list [1276,1297]
                                argument [1277,1280]
                                    expr [1277,1280]
                                        name: vma [1277,1280]
                                argument [1282,1294]
                                    expr [1282,1294]
                                        name [1282,1294]
                                            name: mem [1282,1285]
                                            operator: -> [1285,1287]
                                            name: vmalloc [1287,1294]
                                argument [1295,1296]
                                    expr [1295,1296]
                                        literal: 0 [1295,1296]
                if_stmt [1300,1542]
                    if [1300,1542]
                        condition [1303,1313]
                            expr [1304,1312]
                                name: retval [1304,1310]
                                operator: < [1310,1311]
                                literal: 0 [1311,1312]
                        block [1314,1542]
                            block_content [1318,1539]
                                expr_stmt [1318,1370]
                                    expr [1318,1369]
                                        call [1318,1369]
                                            name: dprintk [1318,1325]
                                            argument_list [1325,1369]
                                                argument [1326,1327]
                                                    expr [1326,1327]
                                                        literal: 1 [1326,1327]
                                                argument [1328,1368]
                                                    expr [1328,1368]
                                                        literal: "mmap: postponing remap_vmalloc_range\n" [1328,1368]
                                expr_stmt [1374,1416]
                                    expr [1374,1415]
                                        name [1374,1382]
                                            name: mem [1374,1377]
                                            operator: -> [1377,1379]
                                            name: vma [1379,1382]
                                        operator: = [1382,1383]
                                        call [1383,1415]
                                            name: kmalloc [1383,1390]
                                            argument_list [1390,1415]
                                                argument [1391,1403]
                                                    expr [1391,1403]
                                                        sizeof [1391,1403]
                                                            argument_list [1397,1403]
                                                                argument [1398,1402]
                                                                    expr [1398,1402]
                                                                        operator: * [1398,1399]
                                                                        name: vma [1399,1402]
                                                argument [1404,1414]
                                                    expr [1404,1414]
                                                        name: GFP_KERNEL [1404,1414]
                                if_stmt [1419,1502]
                                    if [1419,1502]
                                        condition [1422,1433]
                                            expr [1423,1432]
                                                operator: ! [1423,1424]
                                                name [1424,1432]
                                                    name: mem [1424,1427]
                                                    operator: -> [1427,1429]
                                                    name: vma [1429,1432]
                                        block [1434,1502]
                                            block_content [1439,1498]
                                                expr_stmt [1439,1450]
                                                    expr [1439,1449]
                                                        call [1439,1449]
                                                            name: kfree [1439,1444]
                                                            argument_list [1444,1449]
                                                                argument [1445,1448]
                                                                    expr [1445,1448]
                                                                        name: map [1445,1448]
                                                expr_stmt [1454,1479]
                                                    expr [1454,1478]
                                                        name [1454,1468]
                                                            name: q [1454,1455]
                                                            operator: -> [1455,1457]
                                                            name: bufs [1457,1461]
                                                            index [1461,1468]
                                                                expr [1462,1467]
                                                                    name: first [1462,1467]
                                                        operator: -> [1468,1470]
                                                        name: map [1470,1473]
                                                        operator: = [1473,1474]
                                                        name: NULL [1474,1478]
                                                return [1483,1498]
                                                    expr [1490,1497]
                                                        operator: - [1490,1491]
                                                        name: ENOMEM [1491,1497]
                                expr_stmt [1505,1539]
                                    expr [1505,1538]
                                        call [1505,1538]
                                            name: memcpy [1505,1511]
                                            argument_list [1511,1538]
                                                argument [1512,1520]
                                                    expr [1512,1520]
                                                        name [1512,1520]
                                                            name: mem [1512,1515]
                                                            operator: -> [1515,1517]
                                                            name: vma [1517,1520]
                                                argument [1521,1524]
                                                    expr [1521,1524]
                                                        name: vma [1521,1524]
                                                argument [1525,1537]
                                                    expr [1525,1537]
                                                        sizeof [1525,1537]
                                                            argument_list [1531,1537]
                                                                argument [1532,1536]
                                                                    expr [1532,1536]
                                                                        operator: * [1532,1533]
                                                                        name: vma [1533,1536]
                expr_stmt [1545,1705]
                    expr [1545,1704]
                        call [1545,1704]
                            name: dprintk [1545,1552]
                            argument_list [1552,1704]
                                argument [1553,1554]
                                    expr [1553,1554]
                                        literal: 1 [1553,1554]
                                argument [1555,1609]
                                    expr [1555,1609]
                                        literal: "mmap %p: q=%p %08lx-%08lx (%lx) pgoff %08lx buf %d\n" [1555,1609]
                                argument [1613,1616]
                                    expr [1613,1616]
                                        name: map [1613,1616]
                                argument [1617,1618]
                                    expr [1617,1618]
                                        name: q [1617,1618]
                                argument [1619,1632]
                                    expr [1619,1632]
                                        name [1619,1632]
                                            name: vma [1619,1622]
                                            operator: -> [1622,1624]
                                            name: vm_start [1624,1632]
                                argument [1633,1644]
                                    expr [1633,1644]
                                        name [1633,1644]
                                            name: vma [1633,1636]
                                            operator: -> [1636,1638]
                                            name: vm_end [1638,1644]
                                argument [1648,1680]
                                    expr [1648,1680]
                                        operator: ( [1648,1649]
                                        name: long [1649,1653]
                                        name: int [1654,1657]
                                        operator: ) [1657,1658]
                                        name [1659,1673]
                                            name: q [1659,1660]
                                            operator: -> [1660,1662]
                                            name: bufs [1662,1666]
                                            index [1666,1673]
                                                expr [1667,1672]
                                                    name: first [1667,1672]
                                        operator: -> [1673,1675]
                                        name: bsize [1675,1680]
                                argument [1684,1697]
                                    expr [1684,1697]
                                        name [1684,1697]
                                            name: vma [1684,1687]
                                            operator: -> [1687,1689]
                                            name: vm_pgoff [1689,1697]
                                argument [1698,1703]
                                    expr [1698,1703]
                                        name: first [1698,1703]
                expr_stmt [1708,1730]
                    expr [1708,1729]
                        call [1708,1729]
                            name: videobuf_vm_open [1708,1724]
                            argument_list [1724,1729]
                                argument [1725,1728]
                                    expr [1725,1728]
                                        name: vma [1725,1728]
                return [1733,1744]
                    expr [1740,1743]
                        operator: ( [1740,1741]
                        literal: 0 [1741,1742]
                        operator: ) [1742,1743]