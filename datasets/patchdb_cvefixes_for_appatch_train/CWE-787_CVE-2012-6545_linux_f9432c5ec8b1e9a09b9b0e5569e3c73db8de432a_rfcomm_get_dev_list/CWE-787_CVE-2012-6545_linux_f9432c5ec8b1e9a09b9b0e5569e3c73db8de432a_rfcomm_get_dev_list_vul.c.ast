unit [0,0]
    function [0,1021]
        type [0,10]
            specifier: static [0,6]
            name: int [7,10]
        name: rfcomm_get_dev_list [11,30]
        parameter_list [30,48]
            parameter [31,47]
                decl [31,47]
                    type [31,44]
                        name: void [31,35]
                        name: __user [36,42]
                        modifier: * [43,44]
                    name: arg [44,47]
        block [49,1021]
            block_content [52,1019]
                decl_stmt [52,75]
                    decl [52,74]
                        type [52,71]
                            name [52,69]
                                name: struct [52,58]
                                name: rfcomm_dev [59,69]
                            modifier: * [70,71]
                        name: dev [71,74]
                decl_stmt [77,108]
                    decl [77,107]
                        type [77,105]
                            name [77,103]
                                name: struct [77,83]
                                name: rfcomm_dev_list_req [84,103]
                            modifier: * [104,105]
                        name: dl [105,107]
                decl_stmt [110,137]
                    decl [110,136]
                        type [110,134]
                            name [110,132]
                                name: struct [110,116]
                                name: rfcomm_dev_info [117,132]
                            modifier: * [133,134]
                        name: di [134,136]
                decl_stmt [139,160]
                    decl [139,148]
                        type [139,142]
                            name: int [139,142]
                        name: n [143,144]
                        init [145,148]
                            expr [147,148]
                                literal: 0 [147,148]
                    decl [150,154]
                        type [139,142]
                        name: size [150,154]
                    decl [156,159]
                        type [139,142]
                        name: err [156,159]
                decl_stmt [162,174]
                    decl [162,173]
                        type [162,165]
                            name: u16 [162,165]
                        name: dev_num [166,173]
                expr_stmt [177,188]
                    expr [177,187]
                        call [177,187]
                            name: BT_DBG [177,183]
                            argument_list [183,187]
                                argument [184,186]
                                    expr [184,186]
                                        literal: "" [184,186]
                if_stmt [191,251]
                    if [191,251]
                        condition [194,233]
                            expr [195,232]
                                call [195,232]
                                    name: get_user [195,203]
                                    argument_list [203,232]
                                        argument [204,211]
                                            expr [204,211]
                                                name: dev_num [204,211]
                                        argument [213,231]
                                            expr [213,231]
                                                operator: ( [213,214]
                                                name: u16 [214,217]
                                                name: __user [218,224]
                                                operator: * [225,226]
                                                operator: ) [226,227]
                                                name: arg [228,231]
                        block [236,251]
                            block_content [236,251]
                                return [236,251]
                                    expr [243,250]
                                        operator: - [243,244]
                                        name: EFAULT [244,250]
                if_stmt [254,328]
                    if [254,328]
                        condition [257,310]
                            expr [258,309]
                                operator: ! [258,259]
                                name: dev_num [259,266]
                                operator: || [267,269]
                                name: dev_num [270,277]
                                operator: > [278,279]
                                operator: ( [280,281]
                                name: PAGE_SIZE [281,290]
                                operator: * [291,292]
                                literal: 4 [293,294]
                                operator: ) [294,295]
                                operator: / [296,297]
                                sizeof [298,309]
                                    argument_list [304,309]
                                        argument [305,308]
                                            expr [305,308]
                                                operator: * [305,306]
                                                name: di [306,308]
                        block [313,328]
                            block_content [313,328]
                                return [313,328]
                                    expr [320,327]
                                        operator: - [320,321]
                                        name: EINVAL [321,327]
                expr_stmt [331,374]
                    expr [331,373]
                        name: size [331,335]
                        operator: = [336,337]
                        sizeof [338,349]
                            argument_list [344,349]
                                argument [345,348]
                                    expr [345,348]
                                        operator: * [345,346]
                                        name: dl [346,348]
                        operator: + [350,351]
                        name: dev_num [352,359]
                        operator: * [360,361]
                        sizeof [362,373]
                            argument_list [368,373]
                                argument [369,372]
                                    expr [369,372]
                                        operator: * [369,370]
                                        name: di [370,372]
                expr_stmt [377,408]
                    expr [377,407]
                        name: dl [377,379]
                        operator: = [380,381]
                        call [382,407]
                            name: kmalloc [382,389]
                            argument_list [389,407]
                                argument [390,394]
                                    expr [390,394]
                                        name: size [390,394]
                                argument [396,406]
                                    expr [396,406]
                                        name: GFP_KERNEL [396,406]
                if_stmt [410,436]
                    if [410,436]
                        condition [413,418]
                            expr [414,417]
                                operator: ! [414,415]
                                name: dl [415,417]
                        block [421,436]
                            block_content [421,436]
                                return [421,436]
                                    expr [428,435]
                                        operator: - [428,429]
                                        name: ENOMEM [429,435]
                expr_stmt [439,457]
                    expr [439,456]
                        name: di [439,441]
                        operator: = [442,443]
                        name [444,456]
                            name: dl [444,446]
                            operator: -> [446,448]
                            name: dev_info [448,456]
                expr_stmt [460,488]
                    expr [460,487]
                        call [460,487]
                            name: spin_lock [460,469]
                            argument_list [469,487]
                                argument [470,486]
                                    expr [470,486]
                                        operator: & [470,471]
                                        name: rfcomm_dev_lock [471,486]
                macro [491,539]
                    name: list_for_each_entry [491,510]
                    argument_list [510,539]
                        argument [511,514]
                        argument [516,532]
                        argument [534,538]
                block [540,851]
                    block_content [544,848]
                        if_stmt [544,604]
                            if [544,604]
                                condition [547,591]
                                    expr [548,590]
                                        call [548,590]
                                            name: test_bit [548,556]
                                            argument_list [556,590]
                                                argument [557,576]
                                                    expr [557,576]
                                                        name: RFCOMM_TTY_RELEASED [557,576]
                                                argument [578,589]
                                                    expr [578,589]
                                                        operator: & [578,579]
                                                        name [579,589]
                                                            name: dev [579,582]
                                                            operator: -> [582,584]
                                                            name: flags [584,589]
                                block [595,604]
                                    block_content [595,604]
                                        continue [595,604]
                        expr_stmt [607,635]
                            expr [607,634]
                                operator: ( [607,608]
                                name: di [608,610]
                                operator: + [611,612]
                                name: n [613,614]
                                operator: ) [614,615]
                                operator: -> [615,617]
                                name: id [617,619]
                                operator: = [625,626]
                                name [627,634]
                                    name: dev [627,630]
                                    operator: -> [630,632]
                                    name: id [632,634]
                        expr_stmt [638,669]
                            expr [638,668]
                                operator: ( [638,639]
                                name: di [639,641]
                                operator: + [642,643]
                                name: n [644,645]
                                operator: ) [645,646]
                                operator: -> [646,648]
                                name: flags [648,653]
                                operator: = [656,657]
                                name [658,668]
                                    name: dev [658,661]
                                    operator: -> [661,663]
                                    name: flags [663,668]
                        expr_stmt [672,708]
                            expr [672,707]
                                operator: ( [672,673]
                                name: di [673,675]
                                operator: + [676,677]
                                name: n [678,679]
                                operator: ) [679,680]
                                operator: -> [680,682]
                                name: state [682,687]
                                operator: = [690,691]
                                name [692,707]
                                    name: dev [692,695]
                                    operator: -> [695,697]
                                    name: dlc [697,700]
                                    operator: -> [700,702]
                                    name: state [702,707]
                        expr_stmt [711,744]
                            expr [711,743]
                                operator: ( [711,712]
                                name: di [712,714]
                                operator: + [715,716]
                                name: n [717,718]
                                operator: ) [718,719]
                                operator: -> [719,721]
                                name: channel [721,728]
                                operator: = [729,730]
                                name [731,743]
                                    name: dev [731,734]
                                    operator: -> [734,736]
                                    name: channel [736,743]
                        expr_stmt [747,780]
                            expr [747,779]
                                call [747,779]
                                    name: bacpy [747,752]
                                    argument_list [752,779]
                                        argument [753,767]
                                            expr [753,767]
                                                operator: & [753,754]
                                                operator: ( [754,755]
                                                name: di [755,757]
                                                operator: + [758,759]
                                                name: n [760,761]
                                                operator: ) [761,762]
                                                operator: -> [762,764]
                                                name: src [764,767]
                                        argument [769,778]
                                            expr [769,778]
                                                operator: & [769,770]
                                                name [770,778]
                                                    name: dev [770,773]
                                                    operator: -> [773,775]
                                                    name: src [775,778]
                        expr_stmt [783,816]
                            expr [783,815]
                                call [783,815]
                                    name: bacpy [783,788]
                                    argument_list [788,815]
                                        argument [789,803]
                                            expr [789,803]
                                                operator: & [789,790]
                                                operator: ( [790,791]
                                                name: di [791,793]
                                                operator: + [794,795]
                                                name: n [796,797]
                                                operator: ) [797,798]
                                                operator: -> [798,800]
                                                name: dst [800,803]
                                        argument [805,814]
                                            expr [805,814]
                                                operator: & [805,806]
                                                name [806,814]
                                                    name: dev [806,809]
                                                    operator: -> [809,811]
                                                    name: dst [811,814]
                        if_stmt [819,848]
                            if [819,848]
                                condition [822,838]
                                    expr [823,837]
                                        operator: ++ [823,825]
                                        name: n [825,826]
                                        operator: >= [827,829]
                                        name: dev_num [830,837]
                                block [842,848]
                                    block_content [842,848]
                                        break [842,848]
                expr_stmt [854,884]
                    expr [854,883]
                        call [854,883]
                            name: spin_unlock [854,865]
                            argument_list [865,883]
                                argument [866,882]
                                    expr [866,882]
                                        operator: & [866,867]
                                        name: rfcomm_dev_lock [867,882]
                expr_stmt [887,903]
                    expr [887,902]
                        name [887,898]
                            name: dl [887,889]
                            operator: -> [889,891]
                            name: dev_num [891,898]
                        operator: = [899,900]
                        name: n [901,902]
                expr_stmt [905,942]
                    expr [905,941]
                        name: size [905,909]
                        operator: = [910,911]
                        sizeof [912,923]
                            argument_list [918,923]
                                argument [919,922]
                                    expr [919,922]
                                        operator: * [919,920]
                                        name: dl [920,922]
                        operator: + [924,925]
                        name: n [926,927]
                        operator: * [928,929]
                        sizeof [930,941]
                            argument_list [936,941]
                                argument [937,940]
                                    expr [937,940]
                                        operator: * [937,938]
                                        name: di [938,940]
                expr_stmt [945,979]
                    expr [945,978]
                        name: err [945,948]
                        operator: = [949,950]
                        call [951,978]
                            name: copy_to_user [951,963]
                            argument_list [963,978]
                                argument [964,967]
                                    expr [964,967]
                                        name: arg [964,967]
                                argument [969,971]
                                    expr [969,971]
                                        name: dl [969,971]
                                argument [973,977]
                                    expr [973,977]
                                        name: size [973,977]
                expr_stmt [981,991]
                    expr [981,990]
                        call [981,990]
                            name: kfree [981,986]
                            argument_list [986,990]
                                argument [987,989]
                                    expr [987,989]
                                        name: dl [987,989]
                return [994,1019]
                    expr [1001,1018]
                        ternary [1001,1018]
                            condition [1001,1006]
                                expr [1001,1004]
                                    name: err [1001,1004]
                            then [1007,1014]
                                expr [1007,1014]
                                    operator: - [1007,1008]
                                    name: EFAULT [1008,1014]
                            else [1015,1018]
                                expr [1017,1018]
                                    literal: 0 [1017,1018]