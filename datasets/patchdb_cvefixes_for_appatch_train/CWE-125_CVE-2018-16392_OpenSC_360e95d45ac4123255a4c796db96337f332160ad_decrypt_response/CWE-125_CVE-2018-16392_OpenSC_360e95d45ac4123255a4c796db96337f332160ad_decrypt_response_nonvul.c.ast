unit [0,0]
    macro [0,109]
        name: decrypt_response [0,16]
        argument_list [16,109]
            argument [17,37]
            argument [39,56]
            argument [58,70]
            argument [72,90]
            argument [92,108]
    block [110,1277]
        block_content [113,1275]
            decl_stmt [113,131]
                decl [113,130]
                    type [113,119]
                        name: size_t [113,119]
                    name: cipher_len [120,130]
            decl_stmt [133,142]
                decl [133,141]
                    type [133,139]
                        name: size_t [133,139]
                    name: i [140,141]
            decl_stmt [144,173]
                decl [144,172]
                    type [144,157]
                        name: unsigned [144,152]
                        name: char [153,157]
                    name [158,164]
                        name: iv [158,160]
                        index [160,164]
                            expr [161,163]
                                literal: 16 [161,163]
                    init [165,172]
                        expr [167,172]
                            block [167,172]
                                expr [169,170]
                                    literal: 0 [169,170]
            decl_stmt [175,213]
                decl [175,212]
                    type [175,188]
                        name: unsigned [175,183]
                        name: char [184,188]
                    name [189,204]
                        name: plaintext [189,198]
                        index [198,204]
                            expr [199,203]
                                literal: 4096 [199,203]
                    init [205,212]
                        expr [207,212]
                            block [207,212]
                                expr [209,210]
                                    literal: 0 [209,210]
            decl_stmt [215,247]
                decl [215,246]
                    type [215,233]
                        name: epass2003_exdata [215,231]
                        modifier: * [232,233]
                    name: exdata [233,239]
                    init [240,246]
                        expr [242,246]
                            name: NULL [242,246]
            if_stmt [250,308]
                if [250,308]
                    condition [253,270]
                        expr [254,269]
                            operator: ! [254,255]
                            name [255,269]
                                name: card [255,259]
                                operator: -> [259,261]
                                name: drv_data [261,269]
                    block [274,308]
                        block_content [274,308]
                            return [274,308]
                                expr [281,307]
                                    name: SC_ERROR_INVALID_ARGUMENTS [281,307]
            expr_stmt [311,355]
                expr [311,354]
                    name: exdata [311,317]
                    operator: = [318,319]
                    operator: ( [320,321]
                    name: epass2003_exdata [321,337]
                    operator: * [338,339]
                    operator: ) [339,340]
                    name [340,354]
                        name: card [340,344]
                        operator: -> [344,346]
                        name: drv_data [346,354]
            comment: /* no cipher */ [358,373]
            if_stmt [375,405]
                if [375,405]
                    condition [378,393]
                        expr [379,392]
                            name [379,384]
                                name: in [379,381]
                                index [381,384]
                                    expr [382,383]
                                        literal: 0 [382,383]
                            operator: == [385,387]
                            literal: 0x99 [388,392]
                    block [396,405]
                        block_content [396,405]
                            return [396,405]
                                expr [403,404]
                                    literal: 0 [403,404]
            comment: /* parse cipher length */ [408,433]
            if_stmt [435,717]
                if [435,506]
                    condition [438,470]
                        expr [439,469]
                            literal: 0x01 [439,443]
                            operator: == [444,446]
                            name [447,452]
                                name: in [447,449]
                                index [449,452]
                                    expr [450,451]
                                        literal: 2 [450,451]
                            operator: && [453,455]
                            literal: 0x82 [456,460]
                            operator: != [461,463]
                            name [464,469]
                                name: in [464,466]
                                index [466,469]
                                    expr [467,468]
                                        literal: 1 [467,468]
                    block [471,506]
                        block_content [475,503]
                            expr_stmt [475,494]
                                expr [475,493]
                                    name: cipher_len [475,485]
                                    operator: = [486,487]
                                    name [488,493]
                                        name: in [488,490]
                                        index [490,493]
                                            expr [491,492]
                                                literal: 1 [491,492]
                            expr_stmt [497,503]
                                expr [497,502]
                                    name: i [497,498]
                                    operator: = [499,500]
                                    literal: 3 [501,502]
                if [508,584]
                    condition [516,548]
                        expr [517,547]
                            literal: 0x01 [517,521]
                            operator: == [522,524]
                            name [525,530]
                                name: in [525,527]
                                index [527,530]
                                    expr [528,529]
                                        literal: 3 [528,529]
                            operator: && [531,533]
                            literal: 0x81 [534,538]
                            operator: == [539,541]
                            name [542,547]
                                name: in [542,544]
                                index [544,547]
                                    expr [545,546]
                                        literal: 1 [545,546]
                    block [549,584]
                        block_content [553,581]
                            expr_stmt [553,572]
                                expr [553,571]
                                    name: cipher_len [553,563]
                                    operator: = [564,565]
                                    name [566,571]
                                        name: in [566,568]
                                        index [568,571]
                                            expr [569,570]
                                                literal: 2 [569,570]
                            expr_stmt [575,581]
                                expr [575,580]
                                    name: i [575,576]
                                    operator: = [577,578]
                                    literal: 4 [579,580]
                if [586,693]
                    condition [594,626]
                        expr [595,625]
                            literal: 0x01 [595,599]
                            operator: == [600,602]
                            name [603,608]
                                name: in [603,605]
                                index [605,608]
                                    expr [606,607]
                                        literal: 4 [606,607]
                            operator: && [609,611]
                            literal: 0x82 [612,616]
                            operator: == [617,619]
                            name [620,625]
                                name: in [620,622]
                                index [622,625]
                                    expr [623,624]
                                        literal: 1 [623,624]
                    block [627,693]
                        block_content [631,690]
                            expr_stmt [631,658]
                                expr [631,657]
                                    name: cipher_len [631,641]
                                    operator: = [642,643]
                                    name [644,649]
                                        name: in [644,646]
                                        index [646,649]
                                            expr [647,648]
                                                literal: 2 [647,648]
                                    operator: * [650,651]
                                    literal: 0x100 [652,657]
                            expr_stmt [661,681]
                                expr [661,680]
                                    name: cipher_len [661,671]
                                    operator: += [672,674]
                                    name [675,680]
                                        name: in [675,677]
                                        index [677,680]
                                            expr [678,679]
                                                literal: 3 [678,679]
                            expr_stmt [684,690]
                                expr [684,689]
                                    name: i [684,685]
                                    operator: = [686,687]
                                    literal: 5 [688,689]
                else [695,717]
                    block [700,717]
                        block_content [704,714]
                            return [704,714]
                                expr [711,713]
                                    operator: - [711,712]
                                    literal: 1 [712,713]
            if_stmt [720,809]
                if [720,809]
                    condition [723,796]
                        expr [724,795]
                            name [724,756]
                                name: cipher_len [724,734]
                                argument_list [735,756]
                                    argument [737,754]
                                        expr [737,754]
                                            literal: 2 [737,738]
                                            operator: || [739,741]
                                            name: i [742,743]
                                            operator: + [743,744]
                                            name: cipher_len [744,754]
                            name: inlen [757,762]
                            operator: || [763,765]
                            name: cipher_len [766,776]
                            operator: > [777,778]
                            sizeof [779,795]
                                name: plaintext [786,795]
                    block [799,809]
                        block_content [799,809]
                            return [799,809]
                                expr [806,808]
                                    operator: - [806,807]
                                    literal: 1 [807,808]
            comment: /* decrypt */ [812,825]
            if_stmt [827,1028]
                if [827,943]
                    condition [830,862]
                        expr [831,861]
                            name: KEY_TYPE_AES [831,843]
                            operator: == [844,846]
                            name [847,861]
                                name: exdata [847,853]
                                operator: -> [853,855]
                                name: smtype [855,861]
                    block [865,943]
                        block_content [865,943]
                            expr_stmt [865,943]
                                expr [865,942]
                                    call [865,942]
                                        name: aes128_decrypt_cbc [865,883]
                                        argument_list [883,942]
                                            argument [884,898]
                                                expr [884,898]
                                                    name [884,898]
                                                        name: exdata [884,890]
                                                        operator: -> [890,892]
                                                        name: sk_enc [892,898]
                                            argument [900,902]
                                                expr [900,902]
                                                    literal: 16 [900,902]
                                            argument [904,906]
                                                expr [904,906]
                                                    name: iv [904,906]
                                            argument [908,914]
                                                expr [908,914]
                                                    operator: & [908,909]
                                                    name [909,914]
                                                        name: in [909,911]
                                                        index [911,914]
                                                            expr [912,913]
                                                                name: i [912,913]
                                            argument [916,930]
                                                expr [916,930]
                                                    name: cipher_len [916,926]
                                                    operator: - [927,928]
                                                    literal: 1 [929,930]
                                            argument [932,941]
                                                expr [932,941]
                                                    name: plaintext [932,941]
                else [945,1028]
                    block [952,1028]
                        block_content [952,1028]
                            expr_stmt [952,1028]
                                expr [952,1027]
                                    call [952,1027]
                                        name: des3_decrypt_cbc [952,968]
                                        argument_list [968,1027]
                                            argument [969,983]
                                                expr [969,983]
                                                    name [969,983]
                                                        name: exdata [969,975]
                                                        operator: -> [975,977]
                                                        name: sk_enc [977,983]
                                            argument [985,987]
                                                expr [985,987]
                                                    literal: 16 [985,987]
                                            argument [989,991]
                                                expr [989,991]
                                                    name: iv [989,991]
                                            argument [993,999]
                                                expr [993,999]
                                                    operator: & [993,994]
                                                    name [994,999]
                                                        name: in [994,996]
                                                        index [996,999]
                                                            expr [997,998]
                                                                name: i [997,998]
                                            argument [1001,1015]
                                                expr [1001,1015]
                                                    name: cipher_len [1001,1011]
                                                    operator: - [1012,1013]
                                                    literal: 1 [1014,1015]
                                            argument [1017,1026]
                                                expr [1017,1026]
                                                    name: plaintext [1017,1026]
            comment: /* unpadding */ [1031,1046]
            while [1048,1129]
                condition [1054,1113]
                    expr [1055,1112]
                        literal: 0x80 [1055,1059]
                        operator: != [1060,1062]
                        name [1063,1088]
                            name: plaintext [1063,1072]
                            index [1072,1088]
                                expr [1073,1087]
                                    name: cipher_len [1073,1083]
                                    operator: - [1084,1085]
                                    literal: 2 [1086,1087]
                        operator: && [1089,1091]
                        operator: ( [1092,1093]
                        name: cipher_len [1093,1103]
                        operator: - [1104,1105]
                        literal: 2 [1106,1107]
                        operator: > [1108,1109]
                        literal: 0 [1110,1111]
                        operator: ) [1111,1112]
                block [1116,1129]
                    block_content [1116,1129]
                        expr_stmt [1116,1129]
                            expr [1116,1128]
                                name: cipher_len [1116,1126]
                                operator: -- [1126,1128]
            if_stmt [1132,1194]
                if [1132,1194]
                    condition [1135,1181]
                        expr [1136,1180]
                            literal: 2 [1136,1137]
                            operator: == [1138,1140]
                            name: cipher_len [1141,1151]
                            operator: || [1152,1154]
                            operator: * [1155,1156]
                            name: out_len [1156,1163]
                            operator: < [1164,1165]
                            name: cipher_len [1166,1176]
                            operator: - [1177,1178]
                            literal: 2 [1179,1180]
                    block [1184,1194]
                        block_content [1184,1194]
                            return [1184,1194]
                                expr [1191,1193]
                                    operator: - [1191,1192]
                                    literal: 1 [1192,1193]
            expr_stmt [1197,1236]
                expr [1197,1235]
                    call [1197,1235]
                        name: memcpy [1197,1203]
                        argument_list [1203,1235]
                            argument [1204,1207]
                                expr [1204,1207]
                                    name: out [1204,1207]
                            argument [1209,1218]
                                expr [1209,1218]
                                    name: plaintext [1209,1218]
                            argument [1220,1234]
                                expr [1220,1234]
                                    name: cipher_len [1220,1230]
                                    operator: - [1231,1232]
                                    literal: 2 [1233,1234]
            expr_stmt [1238,1264]
                expr [1238,1263]
                    operator: * [1238,1239]
                    name: out_len [1239,1246]
                    operator: = [1247,1248]
                    name: cipher_len [1249,1259]
                    operator: - [1260,1261]
                    literal: 2 [1262,1263]
            return [1266,1275]
                expr [1273,1274]
                    literal: 0 [1273,1274]