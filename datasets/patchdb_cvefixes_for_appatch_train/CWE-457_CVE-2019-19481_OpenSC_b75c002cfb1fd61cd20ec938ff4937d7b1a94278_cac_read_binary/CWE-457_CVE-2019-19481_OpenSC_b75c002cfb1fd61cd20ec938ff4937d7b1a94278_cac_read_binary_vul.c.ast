unit [0,0]
    function [0,2000]
        type [0,10]
            specifier: static [0,6]
            name: int [7,10]
        name: cac_read_binary [11,26]
        parameter_list [26,118]
            parameter [27,42]
                decl [27,42]
                    type [27,42]
                        name: sc_card_t [27,36]
                        modifier: * [37,38]
                    name: card [38,42]
            parameter [44,60]
                decl [44,60]
                    type [44,60]
                        name: unsigned [44,52]
                        name: int [53,56]
                    name: idx [57,60]
            parameter [64,82]
                decl [64,82]
                    type [64,82]
                        name: unsigned [64,72]
                        name: char [73,77]
                        modifier: * [78,79]
                    name: buf [79,82]
            parameter [84,96]
                decl [84,96]
                    type [84,96]
                        name: size_t [84,90]
                    name: count [91,96]
            parameter [98,117]
                decl [98,117]
                    type [98,117]
                        name: unsigned [98,106]
                        name: long [107,111]
                    name: flags [112,117]
        block [119,2000]
            block_content [122,1998]
                decl_stmt [122,165]
                    decl [122,164]
                        type [122,142]
                            name: cac_private_data_t [122,140]
                            modifier: * [141,142]
                        name: priv [143,147]
                        init [148,164]
                            expr [150,164]
                                call [150,164]
                                    name: CAC_DATA [150,158]
                                    argument_list [158,164]
                                        argument [159,163]
                                            expr [159,163]
                                                name: card [159,163]
                decl_stmt [167,177]
                    decl [167,176]
                        type [167,170]
                            name: int [167,170]
                        name: r [171,172]
                        init [173,176]
                            expr [175,176]
                                literal: 0 [175,176]
                decl_stmt [179,194]
                    decl [179,193]
                        type [179,183]
                            name: u8 [179,181]
                            modifier: * [182,183]
                        name: val [183,186]
                        init [187,193]
                            expr [189,193]
                                name: NULL [189,193]
                decl_stmt [196,209]
                    decl [196,208]
                        type [196,200]
                            name: u8 [196,198]
                            modifier: * [199,200]
                        name: cert_ptr [200,208]
                decl_stmt [211,226]
                    decl [211,225]
                        type [211,217]
                            name: size_t [211,217]
                        name: val_len [218,225]
                decl_stmt [228,249]
                    decl [228,238]
                        type [228,234]
                            name: size_t [228,234]
                        name: len [235,238]
                    decl [240,248]
                        type [228,234]
                        name: cert_len [240,248]
                decl_stmt [251,264]
                    decl [251,263]
                        type [251,253]
                            name: u8 [251,253]
                        name: cert_type [254,263]
                expr_stmt [267,315]
                    expr [267,314]
                        call [267,314]
                            name: SC_FUNC_CALLED [267,281]
                            argument_list [281,314]
                                argument [282,291]
                                    expr [282,291]
                                        name [282,291]
                                            name: card [282,286]
                                            operator: -> [286,288]
                                            name: ctx [288,291]
                                argument [293,313]
                                    expr [293,313]
                                        name: SC_LOG_DEBUG_VERBOSE [293,313]
                comment: /* if we didn't return it all last time, return the remainder */ [318,382]
                if_stmt [384,730]
                    if [384,730]
                        condition [387,401]
                            expr [388,400]
                                name [388,400]
                                    name: priv [388,392]
                                    operator: -> [392,394]
                                    name: cached [394,400]
                        block [402,730]
                            block_content [406,727]
                                expr_stmt [406,507]
                                    expr [406,506]
                                        call [406,506]
                                            name: sc_log [406,412]
                                            argument_list [412,506]
                                                argument [413,422]
                                                    expr [413,422]
                                                        name [413,422]
                                                            name: card [413,417]
                                                            operator: -> [417,419]
                                                            name: ctx [419,422]
                                                argument [428,490]
                                                    expr [428,490]
                                                        literal: "returning cached value idx=%d count=%" [428,467]
                                                        name: SC_FORMAT_LEN_SIZE_T [467,487]
                                                        literal: "u" [487,490]
                                                argument [495,498]
                                                    expr [495,498]
                                                        name: idx [495,498]
                                                argument [500,505]
                                                    expr [500,505]
                                                        name: count [500,505]
                                if_stmt [510,604]
                                    if [510,604]
                                        condition [513,540]
                                            expr [514,539]
                                                name: idx [514,517]
                                                operator: > [518,519]
                                                name [520,539]
                                                    name: priv [520,524]
                                                    operator: -> [524,526]
                                                    name: cache_buf_len [526,539]
                                        block [541,604]
                                            block_content [546,600]
                                                expr_stmt [546,600]
                                                    expr [546,599]
                                                        call [546,599]
                                                            name: LOG_FUNC_RETURN [546,561]
                                                            argument_list [561,599]
                                                                argument [562,571]
                                                                    expr [562,571]
                                                                        name [562,571]
                                                                            name: card [562,566]
                                                                            operator: -> [566,568]
                                                                            name: ctx [568,571]
                                                                argument [573,598]
                                                                    expr [573,598]
                                                                        name: SC_ERROR_FILE_END_REACHED [573,598]
                                expr_stmt [607,649]
                                    expr [607,648]
                                        name: len [607,610]
                                        operator: = [611,612]
                                        call [613,648]
                                            name: MIN [613,616]
                                            argument_list [616,648]
                                                argument [617,622]
                                                    expr [617,622]
                                                        name: count [617,622]
                                                argument [624,647]
                                                    expr [624,647]
                                                        name [624,643]
                                                            name: priv [624,628]
                                                            operator: -> [628,630]
                                                            name: cache_buf_len [630,643]
                                                        operator: - [643,644]
                                                        name: idx [644,647]
                                expr_stmt [652,692]
                                    expr [652,691]
                                        call [652,691]
                                            name: memcpy [652,658]
                                            argument_list [658,691]
                                                argument [659,662]
                                                    expr [659,662]
                                                        name: buf [659,662]
                                                argument [664,685]
                                                    expr [664,685]
                                                        operator: & [664,665]
                                                        name [665,685]
                                                            name: priv [665,669]
                                                            operator: -> [669,671]
                                                            name: cache_buf [671,680]
                                                            index [680,685]
                                                                expr [681,684]
                                                                    name: idx [681,684]
                                                argument [687,690]
                                                    expr [687,690]
                                                        name: len [687,690]
                                expr_stmt [695,727]
                                    expr [695,726]
                                        call [695,726]
                                            name: LOG_FUNC_RETURN [695,710]
                                            argument_list [710,726]
                                                argument [711,720]
                                                    expr [711,720]
                                                        name [711,720]
                                                            name: card [711,715]
                                                            operator: -> [715,717]
                                                            name: ctx [717,720]
                                                argument [722,725]
                                                    expr [722,725]
                                                        name: len [722,725]
                expr_stmt [733,824]
                    expr [733,823]
                        call [733,823]
                            name: sc_log [733,739]
                            argument_list [739,823]
                                argument [740,749]
                                    expr [740,749]
                                        name [740,749]
                                            name: card [740,744]
                                            operator: -> [744,746]
                                            name: ctx [746,749]
                                argument [754,808]
                                    expr [754,808]
                                        literal: "clearing cache idx=%d count=%" [754,785]
                                        name: SC_FORMAT_LEN_SIZE_T [785,805]
                                        literal: "u" [805,808]
                                argument [812,815]
                                    expr [812,815]
                                        name: idx [812,815]
                                argument [817,822]
                                    expr [817,822]
                                        name: count [817,822]
                expr_stmt [826,848]
                    expr [826,847]
                        call [826,847]
                            name: free [826,830]
                            argument_list [830,847]
                                argument [831,846]
                                    expr [831,846]
                                        name [831,846]
                                            name: priv [831,835]
                                            operator: -> [835,837]
                                            name: cache_buf [837,846]
                expr_stmt [850,873]
                    expr [850,872]
                        name [850,865]
                            name: priv [850,854]
                            operator: -> [854,856]
                            name: cache_buf [856,865]
                        operator: = [866,867]
                        name: NULL [868,872]
                expr_stmt [875,899]
                    expr [875,898]
                        name [875,894]
                            name: priv [875,879]
                            operator: -> [879,881]
                            name: cache_buf_len [881,894]
                        operator: = [895,896]
                        literal: 0 [897,898]
                expr_stmt [902,953]
                    expr [902,952]
                        name: r [902,903]
                        operator: = [904,905]
                        call [906,952]
                            name: cac_cac1_get_certificate [906,930]
                            argument_list [930,952]
                                argument [931,935]
                                    expr [931,935]
                                        name: card [931,935]
                                argument [937,941]
                                    expr [937,941]
                                        operator: & [937,938]
                                        name: val [938,941]
                                argument [943,951]
                                    expr [943,951]
                                        operator: & [943,944]
                                        name: val_len [944,951]
                if_stmt [955,978]
                    if [955,978]
                        condition [958,965]
                            expr [959,964]
                                name: r [959,960]
                                operator: < [961,962]
                                literal: 0 [963,964]
                        block [968,978]
                            block_content [968,978]
                                goto [968,978]
                                    name: done [973,977]
                if_stmt [980,1043]
                    if [980,1043]
                        condition [983,996]
                            expr [984,995]
                                name: val_len [984,991]
                                operator: < [992,993]
                                literal: 1 [994,995]
                        block [997,1043]
                            block_content [1001,1040]
                                expr_stmt [1001,1027]
                                    expr [1001,1026]
                                        name: r [1001,1002]
                                        operator: = [1003,1004]
                                        name: SC_ERROR_INVALID_DATA [1005,1026]
                                goto [1030,1040]
                                    name: done [1035,1039]
                expr_stmt [1046,1065]
                    expr [1046,1064]
                        name: cert_type [1046,1055]
                        operator: = [1056,1057]
                        name [1058,1064]
                            name: val [1058,1061]
                            index [1061,1064]
                                expr [1062,1063]
                                    literal: 0 [1062,1063]
                expr_stmt [1067,1086]
                    expr [1067,1085]
                        name: cert_ptr [1067,1075]
                        operator: = [1076,1077]
                        name: val [1078,1081]
                        operator: + [1082,1083]
                        literal: 1 [1084,1085]
                expr_stmt [1088,1111]
                    expr [1088,1110]
                        name: cert_len [1088,1096]
                        operator: = [1097,1098]
                        name: val_len [1099,1106]
                        operator: - [1107,1108]
                        literal: 1 [1109,1110]
                comment: /* if the info byte is 1, then the cert is compressed, decompress it */ [1114,1185]
                if_stmt [1187,1704]
                    if [1187,1475]
                        condition [1190,1214]
                            expr [1191,1213]
                                operator: ( [1191,1192]
                                name: cert_type [1192,1201]
                                operator: & [1202,1203]
                                literal: 0x3 [1204,1207]
                                operator: ) [1207,1208]
                                operator: == [1209,1211]
                                literal: 1 [1212,1213]
                        block [1215,1475]
                            block_content [1238,1472]
                                ifdef [1217,1235]
                                    directive: ifdef [1218,1223]
                                    name: ENABLE_ZLIB [1224,1235]
                                expr_stmt [1238,1350]
                                    expr [1238,1342]
                                        name: r [1238,1239]
                                        operator: = [1240,1241]
                                        call [1242,1342]
                                            name: sc_decompress_alloc [1242,1261]
                                            argument_list [1261,1342]
                                                argument [1262,1278]
                                                    expr [1262,1278]
                                                        operator: & [1262,1263]
                                                        name [1263,1278]
                                                            name: priv [1263,1267]
                                                            operator: -> [1267,1269]
                                                            name: cache_buf [1269,1278]
                                                argument [1280,1300]
                                                    expr [1280,1300]
                                                        operator: & [1280,1281]
                                                        name [1281,1300]
                                                            name: priv [1281,1285]
                                                            operator: -> [1285,1287]
                                                            name: cache_buf_len [1287,1300]
                                                argument [1305,1313]
                                                    expr [1305,1313]
                                                        name: cert_ptr [1305,1313]
                                                argument [1315,1323]
                                                    expr [1315,1323]
                                                        name: cert_len [1315,1323]
                                                argument [1325,1341]
                                                    expr [1325,1341]
                                                        name: COMPRESSION_AUTO [1325,1341]
                                else [1344,1349]
                                    directive: else [1345,1349]
                                expr_stmt [1352,1412]
                                    expr [1352,1411]
                                        call [1352,1411]
                                            name: sc_log [1352,1358]
                                            argument_list [1358,1411]
                                                argument [1359,1368]
                                                    expr [1359,1368]
                                                        name [1359,1368]
                                                            name: card [1359,1363]
                                                            operator: -> [1363,1365]
                                                            name: ctx [1365,1368]
                                                argument [1370,1410]
                                                    expr [1370,1410]
                                                        literal: "CAC compression not supported, no zlib" [1370,1410]
                                expr_stmt [1415,1450]
                                    expr [1415,1441]
                                        name: r [1415,1416]
                                        operator: = [1417,1418]
                                        name: SC_ERROR_NOT_SUPPORTED [1419,1441]
                                endif [1443,1449]
                                    directive: endif [1444,1449]
                                if_stmt [1452,1472]
                                    if [1452,1472]
                                        condition [1455,1458]
                                            expr [1456,1457]
                                                name: r [1456,1457]
                                        block [1462,1472]
                                            block_content [1462,1472]
                                                goto [1462,1472]
                                                    name: done [1467,1471]
                    if [1476,1704]
                        condition [1484,1498]
                            expr [1485,1497]
                                name: cert_len [1485,1493]
                                operator: > [1494,1495]
                                literal: 0 [1496,1497]
                        block [1499,1704]
                            block_content [1503,1701]
                                expr_stmt [1503,1538]
                                    expr [1503,1537]
                                        name [1503,1518]
                                            name: priv [1503,1507]
                                            operator: -> [1507,1509]
                                            name: cache_buf [1509,1518]
                                        operator: = [1519,1520]
                                        call [1521,1537]
                                            name: malloc [1521,1527]
                                            argument_list [1527,1537]
                                                argument [1528,1536]
                                                    expr [1528,1536]
                                                        name: cert_len [1528,1536]
                                if_stmt [1541,1620]
                                    if [1541,1620]
                                        condition [1544,1569]
                                            expr [1545,1568]
                                                name [1545,1560]
                                                    name: priv [1545,1549]
                                                    operator: -> [1549,1551]
                                                    name: cache_buf [1551,1560]
                                                operator: == [1561,1563]
                                                name: NULL [1564,1568]
                                        block [1570,1620]
                                            block_content [1575,1616]
                                                expr_stmt [1575,1602]
                                                    expr [1575,1601]
                                                        name: r [1575,1576]
                                                        operator: = [1577,1578]
                                                        name: SC_ERROR_OUT_OF_MEMORY [1579,1601]
                                                goto [1606,1616]
                                                    name: done [1611,1615]
                                expr_stmt [1623,1654]
                                    expr [1623,1653]
                                        name [1623,1642]
                                            name: priv [1623,1627]
                                            operator: -> [1627,1629]
                                            name: cache_buf_len [1629,1642]
                                        operator: = [1643,1644]
                                        name: cert_len [1645,1653]
                                expr_stmt [1657,1701]
                                    expr [1657,1700]
                                        call [1657,1700]
                                            name: memcpy [1657,1663]
                                            argument_list [1663,1700]
                                                argument [1664,1679]
                                                    expr [1664,1679]
                                                        name [1664,1679]
                                                            name: priv [1664,1668]
                                                            operator: -> [1668,1670]
                                                            name: cache_buf [1670,1679]
                                                argument [1681,1689]
                                                    expr [1681,1689]
                                                        name: cert_ptr [1681,1689]
                                                argument [1691,1699]
                                                    expr [1691,1699]
                                                        name: cert_len [1691,1699]
                comment: /* OK we've read the data, now copy the required portion out to the callers buffer */ [1707,1792]
                expr_stmt [1794,1811]
                    expr [1794,1810]
                        name [1794,1806]
                            name: priv [1794,1798]
                            operator: -> [1798,1800]
                            name: cached [1800,1806]
                        operator: = [1807,1808]
                        literal: 1 [1809,1810]
                expr_stmt [1813,1855]
                    expr [1813,1854]
                        name: len [1813,1816]
                        operator: = [1817,1818]
                        call [1819,1854]
                            name: MIN [1819,1822]
                            argument_list [1822,1854]
                                argument [1823,1828]
                                    expr [1823,1828]
                                        name: count [1823,1828]
                                argument [1830,1853]
                                    expr [1830,1853]
                                        name [1830,1849]
                                            name: priv [1830,1834]
                                            operator: -> [1834,1836]
                                            name: cache_buf_len [1836,1849]
                                        operator: - [1849,1850]
                                        name: idx [1850,1853]
                if_stmt [1857,1927]
                    if [1857,1927]
                        condition [1860,1884]
                            expr [1861,1883]
                                name: len [1861,1864]
                                operator: && [1865,1867]
                                name [1868,1883]
                                    name: priv [1868,1872]
                                    operator: -> [1872,1874]
                                    name: cache_buf [1874,1883]
                        block [1887,1927]
                            block_content [1887,1927]
                                expr_stmt [1887,1927]
                                    expr [1887,1926]
                                        call [1887,1926]
                                            name: memcpy [1887,1893]
                                            argument_list [1893,1926]
                                                argument [1894,1897]
                                                    expr [1894,1897]
                                                        name: buf [1894,1897]
                                                argument [1899,1920]
                                                    expr [1899,1920]
                                                        operator: & [1899,1900]
                                                        name [1900,1920]
                                                            name: priv [1900,1904]
                                                            operator: -> [1904,1906]
                                                            name: cache_buf [1906,1915]
                                                            index [1915,1920]
                                                                expr [1916,1919]
                                                                    name: idx [1916,1919]
                                                argument [1922,1925]
                                                    expr [1922,1925]
                                                        name: len [1922,1925]
                expr_stmt [1929,1937]
                    expr [1929,1936]
                        name: r [1929,1930]
                        operator: = [1931,1932]
                        name: len [1933,1936]
                label [1938,1943]
                    name: done [1938,1942]
                if_stmt [1945,1966]
                    if [1945,1966]
                        condition [1948,1953]
                            expr [1949,1952]
                                name: val [1949,1952]
                        block [1956,1966]
                            block_content [1956,1966]
                                expr_stmt [1956,1966]
                                    expr [1956,1965]
                                        call [1956,1965]
                                            name: free [1956,1960]
                                            argument_list [1960,1965]
                                                argument [1961,1964]
                                                    expr [1961,1964]
                                                        name: val [1961,1964]
                expr_stmt [1968,1998]
                    expr [1968,1997]
                        call [1968,1997]
                            name: LOG_FUNC_RETURN [1968,1983]
                            argument_list [1983,1997]
                                argument [1984,1993]
                                    expr [1984,1993]
                                        name [1984,1993]
                                            name: card [1984,1988]
                                            operator: -> [1988,1990]
                                            name: ctx [1990,1993]
                                argument [1995,1996]
                                    expr [1995,1996]
                                        name: r [1995,1996]