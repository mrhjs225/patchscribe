unit [0,0]
    function [0,2004]
        type [0,10]
            specifier: static [0,6]
            name: int [7,10]
        name: cac_read_binary [11,26]
        parameter_list [26,118]
            parameter [27,42]
                decl [27,42]
                    type [27,42]
                        name: sc_card_t [27,36]
                        modifier: * [37,38]
                    name: card [38,42]
            parameter [44,60]
                decl [44,60]
                    type [44,60]
                        name: unsigned [44,52]
                        name: int [53,56]
                    name: idx [57,60]
            parameter [64,82]
                decl [64,82]
                    type [64,82]
                        name: unsigned [64,72]
                        name: char [73,77]
                        modifier: * [78,79]
                    name: buf [79,82]
            parameter [84,96]
                decl [84,96]
                    type [84,96]
                        name: size_t [84,90]
                    name: count [91,96]
            parameter [98,117]
                decl [98,117]
                    type [98,117]
                        name: unsigned [98,106]
                        name: long [107,111]
                    name: flags [112,117]
        block [119,2004]
            block_content [122,2002]
                decl_stmt [122,165]
                    decl [122,164]
                        type [122,142]
                            name: cac_private_data_t [122,140]
                            modifier: * [141,142]
                        name: priv [143,147]
                        init [148,164]
                            expr [150,164]
                                call [150,164]
                                    name: CAC_DATA [150,158]
                                    argument_list [158,164]
                                        argument [159,163]
                                            expr [159,163]
                                                name: card [159,163]
                decl_stmt [167,177]
                    decl [167,176]
                        type [167,170]
                            name: int [167,170]
                        name: r [171,172]
                        init [173,176]
                            expr [175,176]
                                literal: 0 [175,176]
                decl_stmt [179,194]
                    decl [179,193]
                        type [179,183]
                            name: u8 [179,181]
                            modifier: * [182,183]
                        name: val [183,186]
                        init [187,193]
                            expr [189,193]
                                name: NULL [189,193]
                decl_stmt [196,209]
                    decl [196,208]
                        type [196,200]
                            name: u8 [196,198]
                            modifier: * [199,200]
                        name: cert_ptr [200,208]
                decl_stmt [211,230]
                    decl [211,229]
                        type [211,217]
                            name: size_t [211,217]
                        name: val_len [218,225]
                        init [226,229]
                            expr [228,229]
                                literal: 0 [228,229]
                decl_stmt [232,253]
                    decl [232,242]
                        type [232,238]
                            name: size_t [232,238]
                        name: len [239,242]
                    decl [244,252]
                        type [232,238]
                        name: cert_len [244,252]
                decl_stmt [255,268]
                    decl [255,267]
                        type [255,257]
                            name: u8 [255,257]
                        name: cert_type [258,267]
                expr_stmt [271,319]
                    expr [271,318]
                        call [271,318]
                            name: SC_FUNC_CALLED [271,285]
                            argument_list [285,318]
                                argument [286,295]
                                    expr [286,295]
                                        name [286,295]
                                            name: card [286,290]
                                            operator: -> [290,292]
                                            name: ctx [292,295]
                                argument [297,317]
                                    expr [297,317]
                                        name: SC_LOG_DEBUG_VERBOSE [297,317]
                comment: /* if we didn't return it all last time, return the remainder */ [322,386]
                if_stmt [388,734]
                    if [388,734]
                        condition [391,405]
                            expr [392,404]
                                name [392,404]
                                    name: priv [392,396]
                                    operator: -> [396,398]
                                    name: cached [398,404]
                        block [406,734]
                            block_content [410,731]
                                expr_stmt [410,511]
                                    expr [410,510]
                                        call [410,510]
                                            name: sc_log [410,416]
                                            argument_list [416,510]
                                                argument [417,426]
                                                    expr [417,426]
                                                        name [417,426]
                                                            name: card [417,421]
                                                            operator: -> [421,423]
                                                            name: ctx [423,426]
                                                argument [432,494]
                                                    expr [432,494]
                                                        literal: "returning cached value idx=%d count=%" [432,471]
                                                        name: SC_FORMAT_LEN_SIZE_T [471,491]
                                                        literal: "u" [491,494]
                                                argument [499,502]
                                                    expr [499,502]
                                                        name: idx [499,502]
                                                argument [504,509]
                                                    expr [504,509]
                                                        name: count [504,509]
                                if_stmt [514,608]
                                    if [514,608]
                                        condition [517,544]
                                            expr [518,543]
                                                name: idx [518,521]
                                                operator: > [522,523]
                                                name [524,543]
                                                    name: priv [524,528]
                                                    operator: -> [528,530]
                                                    name: cache_buf_len [530,543]
                                        block [545,608]
                                            block_content [550,604]
                                                expr_stmt [550,604]
                                                    expr [550,603]
                                                        call [550,603]
                                                            name: LOG_FUNC_RETURN [550,565]
                                                            argument_list [565,603]
                                                                argument [566,575]
                                                                    expr [566,575]
                                                                        name [566,575]
                                                                            name: card [566,570]
                                                                            operator: -> [570,572]
                                                                            name: ctx [572,575]
                                                                argument [577,602]
                                                                    expr [577,602]
                                                                        name: SC_ERROR_FILE_END_REACHED [577,602]
                                expr_stmt [611,653]
                                    expr [611,652]
                                        name: len [611,614]
                                        operator: = [615,616]
                                        call [617,652]
                                            name: MIN [617,620]
                                            argument_list [620,652]
                                                argument [621,626]
                                                    expr [621,626]
                                                        name: count [621,626]
                                                argument [628,651]
                                                    expr [628,651]
                                                        name [628,647]
                                                            name: priv [628,632]
                                                            operator: -> [632,634]
                                                            name: cache_buf_len [634,647]
                                                        operator: - [647,648]
                                                        name: idx [648,651]
                                expr_stmt [656,696]
                                    expr [656,695]
                                        call [656,695]
                                            name: memcpy [656,662]
                                            argument_list [662,695]
                                                argument [663,666]
                                                    expr [663,666]
                                                        name: buf [663,666]
                                                argument [668,689]
                                                    expr [668,689]
                                                        operator: & [668,669]
                                                        name [669,689]
                                                            name: priv [669,673]
                                                            operator: -> [673,675]
                                                            name: cache_buf [675,684]
                                                            index [684,689]
                                                                expr [685,688]
                                                                    name: idx [685,688]
                                                argument [691,694]
                                                    expr [691,694]
                                                        name: len [691,694]
                                expr_stmt [699,731]
                                    expr [699,730]
                                        call [699,730]
                                            name: LOG_FUNC_RETURN [699,714]
                                            argument_list [714,730]
                                                argument [715,724]
                                                    expr [715,724]
                                                        name [715,724]
                                                            name: card [715,719]
                                                            operator: -> [719,721]
                                                            name: ctx [721,724]
                                                argument [726,729]
                                                    expr [726,729]
                                                        name: len [726,729]
                expr_stmt [737,828]
                    expr [737,827]
                        call [737,827]
                            name: sc_log [737,743]
                            argument_list [743,827]
                                argument [744,753]
                                    expr [744,753]
                                        name [744,753]
                                            name: card [744,748]
                                            operator: -> [748,750]
                                            name: ctx [750,753]
                                argument [758,812]
                                    expr [758,812]
                                        literal: "clearing cache idx=%d count=%" [758,789]
                                        name: SC_FORMAT_LEN_SIZE_T [789,809]
                                        literal: "u" [809,812]
                                argument [816,819]
                                    expr [816,819]
                                        name: idx [816,819]
                                argument [821,826]
                                    expr [821,826]
                                        name: count [821,826]
                expr_stmt [830,852]
                    expr [830,851]
                        call [830,851]
                            name: free [830,834]
                            argument_list [834,851]
                                argument [835,850]
                                    expr [835,850]
                                        name [835,850]
                                            name: priv [835,839]
                                            operator: -> [839,841]
                                            name: cache_buf [841,850]
                expr_stmt [854,877]
                    expr [854,876]
                        name [854,869]
                            name: priv [854,858]
                            operator: -> [858,860]
                            name: cache_buf [860,869]
                        operator: = [870,871]
                        name: NULL [872,876]
                expr_stmt [879,903]
                    expr [879,902]
                        name [879,898]
                            name: priv [879,883]
                            operator: -> [883,885]
                            name: cache_buf_len [885,898]
                        operator: = [899,900]
                        literal: 0 [901,902]
                expr_stmt [906,957]
                    expr [906,956]
                        name: r [906,907]
                        operator: = [908,909]
                        call [910,956]
                            name: cac_cac1_get_certificate [910,934]
                            argument_list [934,956]
                                argument [935,939]
                                    expr [935,939]
                                        name: card [935,939]
                                argument [941,945]
                                    expr [941,945]
                                        operator: & [941,942]
                                        name: val [942,945]
                                argument [947,955]
                                    expr [947,955]
                                        operator: & [947,948]
                                        name: val_len [948,955]
                if_stmt [959,982]
                    if [959,982]
                        condition [962,969]
                            expr [963,968]
                                name: r [963,964]
                                operator: < [965,966]
                                literal: 0 [967,968]
                        block [972,982]
                            block_content [972,982]
                                goto [972,982]
                                    name: done [977,981]
                if_stmt [984,1047]
                    if [984,1047]
                        condition [987,1000]
                            expr [988,999]
                                name: val_len [988,995]
                                operator: < [996,997]
                                literal: 1 [998,999]
                        block [1001,1047]
                            block_content [1005,1044]
                                expr_stmt [1005,1031]
                                    expr [1005,1030]
                                        name: r [1005,1006]
                                        operator: = [1007,1008]
                                        name: SC_ERROR_INVALID_DATA [1009,1030]
                                goto [1034,1044]
                                    name: done [1039,1043]
                expr_stmt [1050,1069]
                    expr [1050,1068]
                        name: cert_type [1050,1059]
                        operator: = [1060,1061]
                        name [1062,1068]
                            name: val [1062,1065]
                            index [1065,1068]
                                expr [1066,1067]
                                    literal: 0 [1066,1067]
                expr_stmt [1071,1090]
                    expr [1071,1089]
                        name: cert_ptr [1071,1079]
                        operator: = [1080,1081]
                        name: val [1082,1085]
                        operator: + [1086,1087]
                        literal: 1 [1088,1089]
                expr_stmt [1092,1115]
                    expr [1092,1114]
                        name: cert_len [1092,1100]
                        operator: = [1101,1102]
                        name: val_len [1103,1110]
                        operator: - [1111,1112]
                        literal: 1 [1113,1114]
                comment: /* if the info byte is 1, then the cert is compressed, decompress it */ [1118,1189]
                if_stmt [1191,1708]
                    if [1191,1479]
                        condition [1194,1218]
                            expr [1195,1217]
                                operator: ( [1195,1196]
                                name: cert_type [1196,1205]
                                operator: & [1206,1207]
                                literal: 0x3 [1208,1211]
                                operator: ) [1211,1212]
                                operator: == [1213,1215]
                                literal: 1 [1216,1217]
                        block [1219,1479]
                            block_content [1242,1476]
                                ifdef [1221,1239]
                                    directive: ifdef [1222,1227]
                                    name: ENABLE_ZLIB [1228,1239]
                                expr_stmt [1242,1354]
                                    expr [1242,1346]
                                        name: r [1242,1243]
                                        operator: = [1244,1245]
                                        call [1246,1346]
                                            name: sc_decompress_alloc [1246,1265]
                                            argument_list [1265,1346]
                                                argument [1266,1282]
                                                    expr [1266,1282]
                                                        operator: & [1266,1267]
                                                        name [1267,1282]
                                                            name: priv [1267,1271]
                                                            operator: -> [1271,1273]
                                                            name: cache_buf [1273,1282]
                                                argument [1284,1304]
                                                    expr [1284,1304]
                                                        operator: & [1284,1285]
                                                        name [1285,1304]
                                                            name: priv [1285,1289]
                                                            operator: -> [1289,1291]
                                                            name: cache_buf_len [1291,1304]
                                                argument [1309,1317]
                                                    expr [1309,1317]
                                                        name: cert_ptr [1309,1317]
                                                argument [1319,1327]
                                                    expr [1319,1327]
                                                        name: cert_len [1319,1327]
                                                argument [1329,1345]
                                                    expr [1329,1345]
                                                        name: COMPRESSION_AUTO [1329,1345]
                                else [1348,1353]
                                    directive: else [1349,1353]
                                expr_stmt [1356,1416]
                                    expr [1356,1415]
                                        call [1356,1415]
                                            name: sc_log [1356,1362]
                                            argument_list [1362,1415]
                                                argument [1363,1372]
                                                    expr [1363,1372]
                                                        name [1363,1372]
                                                            name: card [1363,1367]
                                                            operator: -> [1367,1369]
                                                            name: ctx [1369,1372]
                                                argument [1374,1414]
                                                    expr [1374,1414]
                                                        literal: "CAC compression not supported, no zlib" [1374,1414]
                                expr_stmt [1419,1454]
                                    expr [1419,1445]
                                        name: r [1419,1420]
                                        operator: = [1421,1422]
                                        name: SC_ERROR_NOT_SUPPORTED [1423,1445]
                                endif [1447,1453]
                                    directive: endif [1448,1453]
                                if_stmt [1456,1476]
                                    if [1456,1476]
                                        condition [1459,1462]
                                            expr [1460,1461]
                                                name: r [1460,1461]
                                        block [1466,1476]
                                            block_content [1466,1476]
                                                goto [1466,1476]
                                                    name: done [1471,1475]
                    if [1480,1708]
                        condition [1488,1502]
                            expr [1489,1501]
                                name: cert_len [1489,1497]
                                operator: > [1498,1499]
                                literal: 0 [1500,1501]
                        block [1503,1708]
                            block_content [1507,1705]
                                expr_stmt [1507,1542]
                                    expr [1507,1541]
                                        name [1507,1522]
                                            name: priv [1507,1511]
                                            operator: -> [1511,1513]
                                            name: cache_buf [1513,1522]
                                        operator: = [1523,1524]
                                        call [1525,1541]
                                            name: malloc [1525,1531]
                                            argument_list [1531,1541]
                                                argument [1532,1540]
                                                    expr [1532,1540]
                                                        name: cert_len [1532,1540]
                                if_stmt [1545,1624]
                                    if [1545,1624]
                                        condition [1548,1573]
                                            expr [1549,1572]
                                                name [1549,1564]
                                                    name: priv [1549,1553]
                                                    operator: -> [1553,1555]
                                                    name: cache_buf [1555,1564]
                                                operator: == [1565,1567]
                                                name: NULL [1568,1572]
                                        block [1574,1624]
                                            block_content [1579,1620]
                                                expr_stmt [1579,1606]
                                                    expr [1579,1605]
                                                        name: r [1579,1580]
                                                        operator: = [1581,1582]
                                                        name: SC_ERROR_OUT_OF_MEMORY [1583,1605]
                                                goto [1610,1620]
                                                    name: done [1615,1619]
                                expr_stmt [1627,1658]
                                    expr [1627,1657]
                                        name [1627,1646]
                                            name: priv [1627,1631]
                                            operator: -> [1631,1633]
                                            name: cache_buf_len [1633,1646]
                                        operator: = [1647,1648]
                                        name: cert_len [1649,1657]
                                expr_stmt [1661,1705]
                                    expr [1661,1704]
                                        call [1661,1704]
                                            name: memcpy [1661,1667]
                                            argument_list [1667,1704]
                                                argument [1668,1683]
                                                    expr [1668,1683]
                                                        name [1668,1683]
                                                            name: priv [1668,1672]
                                                            operator: -> [1672,1674]
                                                            name: cache_buf [1674,1683]
                                                argument [1685,1693]
                                                    expr [1685,1693]
                                                        name: cert_ptr [1685,1693]
                                                argument [1695,1703]
                                                    expr [1695,1703]
                                                        name: cert_len [1695,1703]
                comment: /* OK we've read the data, now copy the required portion out to the callers buffer */ [1711,1796]
                expr_stmt [1798,1815]
                    expr [1798,1814]
                        name [1798,1810]
                            name: priv [1798,1802]
                            operator: -> [1802,1804]
                            name: cached [1804,1810]
                        operator: = [1811,1812]
                        literal: 1 [1813,1814]
                expr_stmt [1817,1859]
                    expr [1817,1858]
                        name: len [1817,1820]
                        operator: = [1821,1822]
                        call [1823,1858]
                            name: MIN [1823,1826]
                            argument_list [1826,1858]
                                argument [1827,1832]
                                    expr [1827,1832]
                                        name: count [1827,1832]
                                argument [1834,1857]
                                    expr [1834,1857]
                                        name [1834,1853]
                                            name: priv [1834,1838]
                                            operator: -> [1838,1840]
                                            name: cache_buf_len [1840,1853]
                                        operator: - [1853,1854]
                                        name: idx [1854,1857]
                if_stmt [1861,1931]
                    if [1861,1931]
                        condition [1864,1888]
                            expr [1865,1887]
                                name: len [1865,1868]
                                operator: && [1869,1871]
                                name [1872,1887]
                                    name: priv [1872,1876]
                                    operator: -> [1876,1878]
                                    name: cache_buf [1878,1887]
                        block [1891,1931]
                            block_content [1891,1931]
                                expr_stmt [1891,1931]
                                    expr [1891,1930]
                                        call [1891,1930]
                                            name: memcpy [1891,1897]
                                            argument_list [1897,1930]
                                                argument [1898,1901]
                                                    expr [1898,1901]
                                                        name: buf [1898,1901]
                                                argument [1903,1924]
                                                    expr [1903,1924]
                                                        operator: & [1903,1904]
                                                        name [1904,1924]
                                                            name: priv [1904,1908]
                                                            operator: -> [1908,1910]
                                                            name: cache_buf [1910,1919]
                                                            index [1919,1924]
                                                                expr [1920,1923]
                                                                    name: idx [1920,1923]
                                                argument [1926,1929]
                                                    expr [1926,1929]
                                                        name: len [1926,1929]
                expr_stmt [1933,1941]
                    expr [1933,1940]
                        name: r [1933,1934]
                        operator: = [1935,1936]
                        name: len [1937,1940]
                label [1942,1947]
                    name: done [1942,1946]
                if_stmt [1949,1970]
                    if [1949,1970]
                        condition [1952,1957]
                            expr [1953,1956]
                                name: val [1953,1956]
                        block [1960,1970]
                            block_content [1960,1970]
                                expr_stmt [1960,1970]
                                    expr [1960,1969]
                                        call [1960,1969]
                                            name: free [1960,1964]
                                            argument_list [1964,1969]
                                                argument [1965,1968]
                                                    expr [1965,1968]
                                                        name: val [1965,1968]
                expr_stmt [1972,2002]
                    expr [1972,2001]
                        call [1972,2001]
                            name: LOG_FUNC_RETURN [1972,1987]
                            argument_list [1987,2001]
                                argument [1988,1997]
                                    expr [1988,1997]
                                        name [1988,1997]
                                            name: card [1988,1992]
                                            operator: -> [1992,1994]
                                            name: ctx [1994,1997]
                                argument [1999,2000]
                                    expr [1999,2000]
                                        name: r [1999,2000]