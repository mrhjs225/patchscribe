unit [0,0]
    macro [0,184]
        name: do_core_note [0,12]
        argument_list [12,184]
            argument [13,33]
            argument [35,54]
            argument [56,69]
            argument [75,83]
            argument [85,100]
            argument [102,117]
            argument [123,134]
            argument [136,147]
            argument [149,159]
            argument [161,172]
            argument [174,183]
    block [185,5099]
        block_content [203,5097]
            ifdef [187,201]
                directive: ifdef [188,193]
                name: ELFCORE [194,201]
            decl_stmt [203,221]
                decl [203,220]
                    type [203,206]
                        name: int [203,206]
                    name: os_style [207,215]
                    init [216,220]
                        expr [218,220]
                            operator: - [218,219]
                            literal: 1 [219,220]
            comment: /*
	 * Sigh.  The 2.0.36 kernel in Debian 2.1, at* least, doesn't correctly implement name
	 * sections, in core dumps, as specified by* the "Program Linking" section of "UNIX(R) System
	 * V Release 4 Programmer's Guide: ANSI C and* Programming Support Tools", because my copy
	 * clearly says "The first 'namesz' bytes in 'name'* contain a *null-terminated* [emphasis mine]
	 * character representation of the entry's owner* or originator", but the 2.0.36 kernel code
	 * doesn't include the terminating null in the* name....
	 */ [223,780]
            if_stmt [775,940]
                if [775,940]
                    condition [778,907]
                        expr [779,906]
                            operator: ( [779,780]
                            name: namesz [780,786]
                            operator: == [787,789]
                            literal: 4 [790,791]
                            operator: && [792,794]
                            call [795,834]
                                name: strncmp [795,802]
                                argument_list [802,834]
                                    argument [803,822]
                                        expr [803,822]
                                            operator: ( [803,804]
                                            name: char [804,808]
                                            operator: * [809,810]
                                            operator: ) [810,811]
                                            operator: & [811,812]
                                            name [812,822]
                                                name: nbuf [812,816]
                                                index [816,822]
                                                    expr [817,821]
                                                        name: noff [817,821]
                                    argument [824,830]
                                        expr [824,830]
                                            literal: "CORE" [824,830]
                                    argument [832,833]
                                        expr [832,833]
                                            literal: 4 [832,833]
                            operator: == [835,837]
                            literal: 0 [838,839]
                            operator: ) [839,840]
                            operator: || [841,843]
                            operator: ( [849,850]
                            name: namesz [850,856]
                            operator: == [857,859]
                            literal: 5 [860,861]
                            operator: && [862,864]
                            call [865,900]
                                name: strcmp [865,871]
                                argument_list [871,900]
                                    argument [872,891]
                                        expr [872,891]
                                            operator: ( [872,873]
                                            name: char [873,877]
                                            operator: * [878,879]
                                            operator: ) [879,880]
                                            operator: & [880,881]
                                            name [881,891]
                                                name: nbuf [881,885]
                                                index [885,891]
                                                    expr [886,890]
                                                        name: noff [886,890]
                                    argument [893,899]
                                        expr [893,899]
                                            literal: "CORE" [893,899]
                            operator: == [901,903]
                            literal: 0 [904,905]
                            operator: ) [905,906]
                    block [908,940]
                        block_content [912,937]
                            expr_stmt [912,937]
                                expr [912,936]
                                    name: os_style [912,920]
                                    operator: = [921,922]
                                    name: OS_STYLE_SVR4 [923,936]
            if_stmt [943,1044]
                if [943,1044]
                    condition [946,1008]
                        expr [947,1007]
                            operator: ( [947,948]
                            name: namesz [948,954]
                            operator: == [955,957]
                            literal: 8 [958,959]
                            operator: && [960,962]
                            call [963,1001]
                                name: strcmp [963,969]
                                argument_list [969,1001]
                                    argument [970,989]
                                        expr [970,989]
                                            operator: ( [970,971]
                                            name: char [971,975]
                                            operator: * [976,977]
                                            operator: ) [977,978]
                                            operator: & [978,979]
                                            name [979,989]
                                                name: nbuf [979,983]
                                                index [983,989]
                                                    expr [984,988]
                                                        name: noff [984,988]
                                    argument [991,1000]
                                        expr [991,1000]
                                            literal: "FreeBSD" [991,1000]
                            operator: == [1002,1004]
                            literal: 0 [1005,1006]
                            operator: ) [1006,1007]
                    block [1009,1044]
                        block_content [1013,1041]
                            expr_stmt [1013,1041]
                                expr [1013,1040]
                                    name: os_style [1013,1021]
                                    operator: = [1022,1023]
                                    name: OS_STYLE_FREEBSD [1024,1040]
            if_stmt [1047,1162]
                if [1047,1162]
                    condition [1050,1127]
                        expr [1051,1126]
                            operator: ( [1051,1052]
                            name: namesz [1052,1058]
                            operator: >= [1059,1061]
                            literal: 11 [1062,1064]
                            operator: && [1065,1067]
                            call [1068,1115]
                                name: strncmp [1068,1075]
                                argument_list [1075,1115]
                                    argument [1076,1095]
                                        expr [1076,1095]
                                            operator: ( [1076,1077]
                                            name: char [1077,1081]
                                            operator: * [1082,1083]
                                            operator: ) [1083,1084]
                                            operator: & [1084,1085]
                                            name [1085,1095]
                                                name: nbuf [1085,1089]
                                                index [1089,1095]
                                                    expr [1090,1094]
                                                        name: noff [1090,1094]
                                    argument [1097,1110]
                                        expr [1097,1110]
                                            literal: "NetBSD-CORE" [1097,1110]
                                    argument [1112,1114]
                                        expr [1112,1114]
                                            literal: 11 [1112,1114]
                            operator: == [1121,1123]
                            literal: 0 [1124,1125]
                            operator: ) [1125,1126]
                    block [1128,1162]
                        block_content [1132,1159]
                            expr_stmt [1132,1159]
                                expr [1132,1158]
                                    name: os_style [1132,1140]
                                    operator: = [1141,1142]
                                    name: OS_STYLE_NETBSD [1143,1158]
            if_stmt [1165,1373]
                if [1165,1373]
                    condition [1168,1224]
                        expr [1169,1223]
                            name: os_style [1169,1177]
                            operator: != [1178,1180]
                            operator: - [1181,1182]
                            literal: 1 [1182,1183]
                            operator: && [1184,1186]
                            operator: ( [1187,1188]
                            operator: * [1188,1189]
                            name: flags [1189,1194]
                            operator: & [1195,1196]
                            name: FLAGS_DID_CORE_STYLE [1197,1217]
                            operator: ) [1217,1218]
                            operator: == [1219,1221]
                            literal: 0 [1222,1223]
                    block [1225,1373]
                        block_content [1229,1370]
                            if_stmt [1229,1314]
                                if [1229,1314]
                                    condition [1232,1301]
                                        expr [1233,1300]
                                            call [1233,1288]
                                                name: file_printf [1233,1244]
                                                argument_list [1244,1288]
                                                    argument [1245,1247]
                                                        expr [1245,1247]
                                                            name: ms [1245,1247]
                                                    argument [1249,1261]
                                                        expr [1249,1261]
                                                            literal: ", %s-style" [1249,1261]
                                                    argument [1263,1287]
                                                        expr [1263,1287]
                                                            name [1263,1287]
                                                                name: os_style_names [1263,1277]
                                                                index [1277,1287]
                                                                    expr [1278,1286]
                                                                        name: os_style [1278,1286]
                                            operator: == [1295,1297]
                                            operator: - [1298,1299]
                                            literal: 1 [1299,1300]
                                    block [1305,1314]
                                        block_content [1305,1314]
                                            return [1305,1314]
                                                expr [1312,1313]
                                                    literal: 1 [1312,1313]
                            expr_stmt [1317,1348]
                                expr [1317,1347]
                                    operator: * [1317,1318]
                                    name: flags [1318,1323]
                                    operator: |= [1324,1326]
                                    name: FLAGS_DID_CORE_STYLE [1327,1347]
                            expr_stmt [1351,1370]
                                expr [1351,1369]
                                    operator: * [1351,1352]
                                    name: flags [1352,1357]
                                    operator: |= [1358,1360]
                                    name: os_style [1361,1369]
            switch [1376,5087]
                condition [1383,1393]
                    expr [1384,1392]
                        name: os_style [1384,1392]
                block [1394,5087]
                    block_content [1397,5076]
                        case [1397,1418]
                            expr [1402,1417]
                                name: OS_STYLE_NETBSD [1402,1417]
                        if_stmt [1421,2153]
                            if [1421,2153]
                                condition [1424,1457]
                                    expr [1425,1456]
                                        name: type [1425,1429]
                                        operator: == [1430,1432]
                                        name: NT_NETBSD_CORE_PROCINFO [1433,1456]
                                block [1458,2153]
                                    block_content [1463,2149]
                                        decl_stmt [1463,1478]
                                            decl [1463,1477]
                                                type [1463,1467]
                                                    name: char [1463,1467]
                                                name [1468,1477]
                                                    name: sbuf [1468,1472]
                                                    index [1472,1477]
                                                        expr [1473,1476]
                                                            literal: 512 [1473,1476]
                                        decl_stmt [1482,1516]
                                            decl [1482,1515]
                                                type [1482,1512]
                                                    name [1482,1512]
                                                        name: struct [1482,1488]
                                                        name: NetBSD_elfcore_procinfo [1489,1512]
                                                name: pi [1513,1515]
                                        expr_stmt [1520,1547]
                                            expr [1520,1546]
                                                call [1520,1546]
                                                    name: memset [1520,1526]
                                                    argument_list [1526,1546]
                                                        argument [1527,1530]
                                                            expr [1527,1530]
                                                                operator: & [1527,1528]
                                                                name: pi [1528,1530]
                                                        argument [1532,1533]
                                                            expr [1532,1533]
                                                                literal: 0 [1532,1533]
                                                        argument [1535,1545]
                                                            expr [1535,1545]
                                                                sizeof [1535,1545]
                                                                    argument_list [1541,1545]
                                                                        argument [1542,1544]
                                                                            expr [1542,1544]
                                                                                name: pi [1542,1544]
                                        expr_stmt [1551,1601]
                                            expr [1551,1600]
                                                call [1551,1600]
                                                    name: memcpy [1551,1557]
                                                    argument_list [1557,1600]
                                                        argument [1558,1561]
                                                            expr [1558,1561]
                                                                operator: & [1558,1559]
                                                                name: pi [1559,1561]
                                                        argument [1563,1574]
                                                            expr [1563,1574]
                                                                name: nbuf [1563,1567]
                                                                operator: + [1568,1569]
                                                                name: doff [1570,1574]
                                                        argument [1576,1599]
                                                            expr [1576,1599]
                                                                call [1576,1599]
                                                                    name: MIN [1576,1579]
                                                                    argument_list [1579,1599]
                                                                        argument [1580,1586]
                                                                            expr [1580,1586]
                                                                                name: descsz [1580,1586]
                                                                        argument [1588,1598]
                                                                            expr [1588,1598]
                                                                                sizeof [1588,1598]
                                                                                    argument_list [1594,1598]
                                                                                        argument [1595,1597]
                                                                                            expr [1595,1597]
                                                                                                name: pi [1595,1597]
                                        if_stmt [1606,2106]
                                            if [1606,2106]
                                                condition [1609,2092]
                                                    expr [1610,2091]
                                                        call [1610,2085]
                                                            name: file_printf [1610,1621]
                                                            argument_list [1621,2085]
                                                                argument [1622,1624]
                                                                    expr [1622,1624]
                                                                        name: ms [1622,1624]
                                                                argument [1626,1714]
                                                                    expr [1626,1714]
                                                                        literal: ", from '%.31s', pid=%u, uid=%u, " [1626,1660]
                                                                        literal: "gid=%u, nlwps=%u, lwp=%u (signal %u/code %u)" [1668,1714]
                                                                argument [1723,1792]
                                                                    expr [1723,1792]
                                                                        call [1723,1792]
                                                                            name: file_printable [1723,1737]
                                                                            argument_list [1737,1792]
                                                                                argument [1738,1742]
                                                                                    expr [1738,1742]
                                                                                        name: sbuf [1738,1742]
                                                                                argument [1744,1756]
                                                                                    expr [1744,1756]
                                                                                        sizeof [1744,1756]
                                                                                            argument_list [1750,1756]
                                                                                                argument [1751,1755]
                                                                                                    expr [1751,1755]
                                                                                                        name: sbuf [1751,1755]
                                                                                argument [1765,1791]
                                                                                    expr [1765,1791]
                                                                                        call [1765,1791]
                                                                                            name: RCAST [1765,1770]
                                                                                            argument_list [1770,1791]
                                                                                                argument [1771,1777]
                                                                                                    expr [1771,1777]
                                                                                                        name: char [1771,1775]
                                                                                                        operator: * [1776,1777]
                                                                                                argument [1779,1790]
                                                                                                    expr [1779,1790]
                                                                                                        name [1779,1790]
                                                                                                            name: pi [1779,1781]
                                                                                                            operator: . [1781,1782]
                                                                                                            name: cpi_name [1782,1790]
                                                                argument [1801,1839]
                                                                    expr [1801,1839]
                                                                        call [1801,1839]
                                                                            name: elf_getu32 [1801,1811]
                                                                            argument_list [1811,1839]
                                                                                argument [1812,1816]
                                                                                    expr [1812,1816]
                                                                                        name: swap [1812,1816]
                                                                                argument [1818,1838]
                                                                                    expr [1818,1838]
                                                                                        operator: ( [1818,1819]
                                                                                        name: uint32_t [1819,1827]
                                                                                        operator: ) [1827,1828]
                                                                                        name [1828,1838]
                                                                                            name: pi [1828,1830]
                                                                                            operator: . [1830,1831]
                                                                                            name: cpi_pid [1831,1838]
                                                                argument [1848,1877]
                                                                    expr [1848,1877]
                                                                        call [1848,1877]
                                                                            name: elf_getu32 [1848,1858]
                                                                            argument_list [1858,1877]
                                                                                argument [1859,1863]
                                                                                    expr [1859,1863]
                                                                                        name: swap [1859,1863]
                                                                                argument [1865,1876]
                                                                                    expr [1865,1876]
                                                                                        name [1865,1876]
                                                                                            name: pi [1865,1867]
                                                                                            operator: . [1867,1868]
                                                                                            name: cpi_euid [1868,1876]
                                                                argument [1886,1915]
                                                                    expr [1886,1915]
                                                                        call [1886,1915]
                                                                            name: elf_getu32 [1886,1896]
                                                                            argument_list [1896,1915]
                                                                                argument [1897,1901]
                                                                                    expr [1897,1901]
                                                                                        name: swap [1897,1901]
                                                                                argument [1903,1914]
                                                                                    expr [1903,1914]
                                                                                        name [1903,1914]
                                                                                            name: pi [1903,1905]
                                                                                            operator: . [1905,1906]
                                                                                            name: cpi_egid [1906,1914]
                                                                argument [1924,1954]
                                                                    expr [1924,1954]
                                                                        call [1924,1954]
                                                                            name: elf_getu32 [1924,1934]
                                                                            argument_list [1934,1954]
                                                                                argument [1935,1939]
                                                                                    expr [1935,1939]
                                                                                        name: swap [1935,1939]
                                                                                argument [1941,1953]
                                                                                    expr [1941,1953]
                                                                                        name [1941,1953]
                                                                                            name: pi [1941,1943]
                                                                                            operator: . [1943,1944]
                                                                                            name: cpi_nlwps [1944,1953]
                                                                argument [1963,2004]
                                                                    expr [1963,2004]
                                                                        call [1963,2004]
                                                                            name: elf_getu32 [1963,1973]
                                                                            argument_list [1973,2004]
                                                                                argument [1974,1978]
                                                                                    expr [1974,1978]
                                                                                        name: swap [1974,1978]
                                                                                argument [1980,2003]
                                                                                    expr [1980,2003]
                                                                                        operator: ( [1980,1981]
                                                                                        name: uint32_t [1981,1989]
                                                                                        operator: ) [1989,1990]
                                                                                        name [1990,2003]
                                                                                            name: pi [1990,1992]
                                                                                            operator: . [1992,1993]
                                                                                            name: cpi_siglwp [1993,2003]
                                                                argument [2013,2043]
                                                                    expr [2013,2043]
                                                                        call [2013,2043]
                                                                            name: elf_getu32 [2013,2023]
                                                                            argument_list [2023,2043]
                                                                                argument [2024,2028]
                                                                                    expr [2024,2028]
                                                                                        name: swap [2024,2028]
                                                                                argument [2030,2042]
                                                                                    expr [2030,2042]
                                                                                        name [2030,2042]
                                                                                            name: pi [2030,2032]
                                                                                            operator: . [2032,2033]
                                                                                            name: cpi_signo [2033,2042]
                                                                argument [2052,2084]
                                                                    expr [2052,2084]
                                                                        call [2052,2084]
                                                                            name: elf_getu32 [2052,2062]
                                                                            argument_list [2062,2084]
                                                                                argument [2063,2067]
                                                                                    expr [2063,2067]
                                                                                        name: swap [2063,2067]
                                                                                argument [2069,2083]
                                                                                    expr [2069,2083]
                                                                                        name [2069,2083]
                                                                                            name: pi [2069,2071]
                                                                                            operator: . [2071,2072]
                                                                                            name: cpi_sigcode [2072,2083]
                                                        operator: == [2086,2088]
                                                        operator: - [2089,2090]
                                                        literal: 1 [2090,2091]
                                                block [2097,2106]
                                                    block_content [2097,2106]
                                                        return [2097,2106]
                                                            expr [2104,2105]
                                                                literal: 1 [2104,2105]
                                        expr_stmt [2111,2136]
                                            expr [2111,2135]
                                                operator: * [2111,2112]
                                                name: flags [2112,2117]
                                                operator: |= [2118,2120]
                                                name: FLAGS_DID_CORE [2121,2135]
                                        return [2140,2149]
                                            expr [2147,2148]
                                                literal: 1 [2147,2148]
                        break [2156,2162]
                        case [2165,2187]
                            expr [2170,2186]
                                name: OS_STYLE_FREEBSD [2170,2186]
                        if_stmt [2190,2689]
                            if [2190,2689]
                                condition [2193,2240]
                                    expr [2194,2239]
                                        name: type [2194,2198]
                                        operator: == [2199,2201]
                                        name: NT_PRPSINFO [2202,2213]
                                        operator: && [2214,2216]
                                        operator: * [2217,2218]
                                        name: flags [2218,2223]
                                        operator: & [2224,2225]
                                        name: FLAGS_IS_CORE [2226,2239]
                                block [2241,2689]
                                    block_content [2246,2685]
                                        decl_stmt [2246,2268]
                                            decl [2246,2259]
                                                type [2246,2252]
                                                    name: size_t [2246,2252]
                                                name: argoff [2253,2259]
                                            decl [2261,2267]
                                                type [2246,2252]
                                                name: pidoff [2261,2267]
                                        if_stmt [2273,2359]
                                            if [2273,2322]
                                                condition [2276,2297]
                                                    expr [2277,2296]
                                                        name: clazz [2277,2282]
                                                        operator: == [2283,2285]
                                                        name: ELFCLASS32 [2286,2296]
                                                block [2302,2322]
                                                    block_content [2302,2322]
                                                        expr_stmt [2302,2322]
                                                            expr [2302,2321]
                                                                name: argoff [2302,2308]
                                                                operator: = [2309,2310]
                                                                literal: 4 [2311,2314]
                                                                operator: + [2313,2314]
                                                                literal: 4 [2315,2318]
                                                                operator: + [2317,2318]
                                                                literal: 17 [2319,2321]
                                            else [2326,2359]
                                                block [2335,2359]
                                                    block_content [2335,2359]
                                                        expr_stmt [2335,2359]
                                                            expr [2335,2358]
                                                                name: argoff [2335,2341]
                                                                operator: = [2342,2343]
                                                                literal: 4 [2344,2347]
                                                                operator: + [2346,2347]
                                                                literal: 4 [2348,2351]
                                                                operator: + [2350,2351]
                                                                literal: 8 [2352,2355]
                                                                operator: + [2354,2355]
                                                                literal: 17 [2356,2358]
                                        if_stmt [2363,2450]
                                            if [2363,2450]
                                                condition [2366,2436]
                                                    expr [2367,2435]
                                                        call [2367,2429]
                                                            name: file_printf [2367,2378]
                                                            argument_list [2378,2429]
                                                                argument [2379,2381]
                                                                    expr [2379,2381]
                                                                        name: ms [2379,2381]
                                                                argument [2383,2399]
                                                                    expr [2383,2399]
                                                                        literal: ", from '%.80s'" [2383,2399]
                                                                argument [2401,2428]
                                                                    expr [2401,2428]
                                                                        name: nbuf [2401,2405]
                                                                        operator: + [2406,2407]
                                                                        name: doff [2408,2412]
                                                                        operator: + [2413,2414]
                                                                        name: argoff [2422,2428]
                                                        operator: == [2430,2432]
                                                        operator: - [2433,2434]
                                                        literal: 1 [2434,2435]
                                                block [2441,2450]
                                                    block_content [2441,2450]
                                                        return [2441,2450]
                                                            expr [2448,2449]
                                                                literal: 1 [2448,2449]
                                        expr_stmt [2454,2479]
                                            expr [2454,2478]
                                                name: pidoff [2454,2460]
                                                operator: = [2461,2462]
                                                name: argoff [2463,2469]
                                                operator: + [2470,2471]
                                                literal: 81 [2472,2476]
                                                operator: + [2475,2476]
                                                literal: 2 [2477,2478]
                                        if_stmt [2483,2656]
                                            if [2483,2656]
                                                condition [2486,2513]
                                                    expr [2487,2512]
                                                        name: doff [2487,2491]
                                                        operator: + [2492,2493]
                                                        name: pidoff [2494,2500]
                                                        operator: + [2501,2502]
                                                        literal: 4 [2503,2504]
                                                        operator: <= [2505,2507]
                                                        name: size [2508,2512]
                                                block [2514,2656]
                                                    block_content [2520,2651]
                                                        if_stmt [2520,2651]
                                                            if [2520,2651]
                                                                condition [2523,2636]
                                                                    expr [2524,2635]
                                                                        call [2524,2629]
                                                                            name: file_printf [2524,2535]
                                                                            argument_list [2535,2629]
                                                                                argument [2536,2538]
                                                                                    expr [2536,2538]
                                                                                        name: ms [2536,2538]
                                                                                argument [2540,2550]
                                                                                    expr [2540,2550]
                                                                                        literal: ", pid=%u" [2540,2550]
                                                                                argument [2560,2628]
                                                                                    expr [2560,2628]
                                                                                        call [2560,2628]
                                                                                            name: elf_getu32 [2560,2570]
                                                                                            argument_list [2570,2628]
                                                                                                argument [2571,2575]
                                                                                                    expr [2571,2575]
                                                                                                        name: swap [2571,2575]
                                                                                                argument [2577,2627]
                                                                                                    expr [2577,2627]
                                                                                                        operator: * [2577,2578]
                                                                                                        call [2578,2627]
                                                                                                            name: RCAST [2578,2583]
                                                                                                            argument_list [2583,2627]
                                                                                                                argument [2584,2594]
                                                                                                                    expr [2584,2594]
                                                                                                                        name: uint32_t [2584,2592]
                                                                                                                        operator: * [2593,2594]
                                                                                                                argument [2596,2626]
                                                                                                                    expr [2596,2626]
                                                                                                                        operator: ( [2596,2597]
                                                                                                                        name: nbuf [2597,2601]
                                                                                                                        operator: + [2602,2603]
                                                                                                                        name: doff [2612,2616]
                                                                                                                        operator: + [2617,2618]
                                                                                                                        name: pidoff [2619,2625]
                                                                                                                        operator: ) [2625,2626]
                                                                        operator: == [2630,2632]
                                                                        operator: - [2633,2634]
                                                                        literal: 1 [2634,2635]
                                                                block [2642,2651]
                                                                    block_content [2642,2651]
                                                                        return [2642,2651]
                                                                            expr [2649,2650]
                                                                                literal: 1 [2649,2650]
                                        expr_stmt [2660,2685]
                                            expr [2660,2684]
                                                operator: * [2660,2661]
                                                name: flags [2661,2666]
                                                operator: |= [2667,2669]
                                                name: FLAGS_DID_CORE [2670,2684]
                        break [2699,2705]
                        default [2708,2716]
                        if_stmt [2719,5067]
                            if [2719,5067]
                                condition [2722,2769]
                                    expr [2723,2768]
                                        name: type [2723,2727]
                                        operator: == [2728,2730]
                                        name: NT_PRPSINFO [2731,2742]
                                        operator: && [2743,2745]
                                        operator: * [2746,2747]
                                        name: flags [2747,2752]
                                        operator: & [2753,2754]
                                        name: FLAGS_IS_CORE [2755,2768]
                                block [2770,5067]
                                    block_content [2775,5063]
                                        decl_stmt [2775,2787]
                                            decl [2775,2783]
                                                type [2775,2781]
                                                    name: size_t [2775,2781]
                                                name: i [2782,2783]
                                            decl [2785,2786]
                                                type [2775,2781]
                                                name: j [2785,2786]
                                        decl_stmt [2791,2807]
                                            decl [2791,2806]
                                                type [2791,2804]
                                                    name: unsigned [2791,2799]
                                                    name: char [2800,2804]
                                                name: c [2805,2806]
                                        comment: /*
			 * Extract the program name.  We assume* it to be 16 characters (that's what it
			 * is in SunOS 5.x and Linux).*
			 * Unfortunately, it's at a different offset* in various OSes, so try multiple offsets.
			 * If the characters aren't all printable,* reject it.
			 */ [2811,3128]
                                        for [3111,5063]
                                            control [3115,3141]
                                                init [3116,3122]
                                                    expr [3116,3121]
                                                        name: i [3116,3117]
                                                        operator: = [3118,3119]
                                                        literal: 0 [3120,3121]
                                                condition [3123,3136]
                                                    expr [3123,3135]
                                                        name: i [3123,3124]
                                                        operator: < [3125,3126]
                                                        name: NOFFSETS [3127,3135]
                                                incr [3137,3140]
                                                    expr [3137,3140]
                                                        name: i [3137,3138]
                                                        operator: ++ [3138,3140]
                                            block [3142,5063]
                                                block_content [3148,5058]
                                                    decl_stmt [3148,3174]
                                                        decl [3148,3168]
                                                            type [3148,3163]
                                                                name: unsigned [3148,3156]
                                                                name: char [3157,3161]
                                                                modifier: * [3162,3163]
                                                            name: cname [3163,3168]
                                                        decl [3170,3173]
                                                            type [3148,3163]
                                                                modifier: * [3170,3171]
                                                            name: cp [3171,3173]
                                                    decl_stmt [3179,3213]
                                                        decl [3179,3212]
                                                            type [3179,3185]
                                                                name: size_t [3179,3185]
                                                            name: reloffset [3186,3195]
                                                            init [3196,3212]
                                                                expr [3198,3212]
                                                                    call [3198,3212]
                                                                        name: prpsoffsets [3198,3209]
                                                                        argument_list [3209,3212]
                                                                            argument [3210,3211]
                                                                                expr [3210,3211]
                                                                                    name: i [3210,3211]
                                                    decl_stmt [3218,3252]
                                                        decl [3218,3251]
                                                            type [3218,3224]
                                                                name: size_t [3218,3224]
                                                            name: noffset [3225,3232]
                                                            init [3233,3251]
                                                                expr [3235,3251]
                                                                    name: doff [3235,3239]
                                                                    operator: + [3240,3241]
                                                                    name: reloffset [3242,3251]
                                                    decl_stmt [3257,3266]
                                                        decl [3257,3265]
                                                            type [3257,3263]
                                                                name: size_t [3257,3263]
                                                            name: k [3264,3265]
                                                    for [3271,4124]
                                                        control [3275,3327]
                                                            init [3276,3282]
                                                                expr [3276,3281]
                                                                    name: j [3276,3277]
                                                                    operator: = [3278,3279]
                                                                    literal: 0 [3280,3281]
                                                            condition [3283,3290]
                                                                expr [3283,3289]
                                                                    name: j [3283,3284]
                                                                    operator: < [3285,3286]
                                                                    literal: 16 [3287,3289]
                                                            incr [3291,3326]
                                                                expr [3291,3294]
                                                                    name: j [3291,3292]
                                                                    operator: ++ [3292,3294]
                                                                operator: , [3294,3295]
                                                                expr [3296,3305]
                                                                    name: noffset [3296,3303]
                                                                    operator: ++ [3303,3305]
                                                                operator: , [3305,3306]
                                                                expr [3315,3326]
                                                                    name: reloffset [3315,3324]
                                                                    operator: ++ [3324,3326]
                                                        block [3328,4124]
                                                            block_content [3449,4118]
                                                                comment: /*
					 * Make sure we're not past* the end of the buffer; if
					 * we are, just give up.*/ [3335,3478]
                                                                if_stmt [3449,3492]
                                                                    if [3449,3492]
                                                                        condition [3452,3469]
                                                                            expr [3453,3468]
                                                                                name: noffset [3453,3460]
                                                                                operator: >= [3461,3463]
                                                                                name: size [3464,3468]
                                                                        block [3476,3492]
                                                                            block_content [3476,3492]
                                                                                goto [3476,3492]
                                                                                    name: tryanother [3481,3491]
                                                                comment: /*
					 * Make sure we're not past* the end of the contents;
					 * if we are, this obviously* isn't the right offset.
					 */ [3499,3677]
                                                                if_stmt [3648,3695]
                                                                    if [3648,3695]
                                                                        condition [3651,3672]
                                                                            expr [3652,3671]
                                                                                name: reloffset [3652,3661]
                                                                                operator: >= [3662,3664]
                                                                                name: descsz [3665,3671]
                                                                        block [3679,3695]
                                                                            block_content [3679,3695]
                                                                                goto [3679,3695]
                                                                                    name: tryanother [3684,3694]
                                                                expr_stmt [3702,3720]
                                                                    expr [3702,3719]
                                                                        name: c [3702,3703]
                                                                        operator: = [3704,3705]
                                                                        name [3706,3719]
                                                                            name: nbuf [3706,3710]
                                                                            index [3710,3719]
                                                                                expr [3711,3718]
                                                                                    name: noffset [3711,3718]
                                                                if_stmt [3726,4118]
                                                                    if [3726,3957]
                                                                        condition [3729,3740]
                                                                            expr [3730,3739]
                                                                                name: c [3730,3731]
                                                                                operator: == [3732,3734]
                                                                                literal: '\0' [3735,3739]
                                                                        block [3741,3957]
                                                                            block_content [3890,3950]
                                                                                comment: /*
						 * A '\0' at the* beginning is
						 * obviously wrong.* Any other '\0'
						 * means we're done.*/ [3749,3925]
                                                                                if_stmt [3890,3950]
                                                                                    if [3890,3925]
                                                                                        condition [3893,3901]
                                                                                            expr [3894,3900]
                                                                                                name: j [3894,3895]
                                                                                                operator: == [3896,3898]
                                                                                                literal: 0 [3899,3900]
                                                                                        block [3909,3925]
                                                                                            block_content [3909,3925]
                                                                                                goto [3909,3925]
                                                                                                    name: tryanother [3914,3924]
                                                                                    else [3932,3950]
                                                                                        block [3944,3950]
                                                                                            block_content [3944,3950]
                                                                                                break [3944,3950]
                                                                    else [3958,4118]
                                                                        block [3963,4118]
                                                                            block_content [4057,4111]
                                                                                comment: /*
						 * A nonprintable* character is also
						 * wrong.*/ [3971,4092]
                                                                                if_stmt [4057,4111]
                                                                                    if [4057,4111]
                                                                                        condition [4060,4087]
                                                                                            expr [4061,4086]
                                                                                                operator: ! [4061,4062]
                                                                                                call [4062,4072]
                                                                                                    name: isprint [4062,4069]
                                                                                                    argument_list [4069,4072]
                                                                                                        argument [4070,4071]
                                                                                                            expr [4070,4071]
                                                                                                                name: c [4070,4071]
                                                                                                operator: || [4073,4075]
                                                                                                call [4076,4086]
                                                                                                    name: isquote [4076,4083]
                                                                                                    argument_list [4083,4086]
                                                                                                        argument [4084,4085]
                                                                                                            expr [4084,4085]
                                                                                                                name: c [4084,4085]
                                                                                        block [4095,4111]
                                                                                            block_content [4095,4111]
                                                                                                goto [4095,4111]
                                                                                                    name: tryanother [4100,4110]
                                                    comment: /*
				 * Well, that worked.*/ [4129,4193]
                                                    comment: /*
				 * Try next offsets, in case this match is* in the middle of a string.
				 */ [4171,4290]
                                                    for [4267,4577]
                                                        control [4271,4302]
                                                            init [4272,4283]
                                                                expr [4272,4281]
                                                                    name: k [4272,4273]
                                                                    operator: = [4274,4275]
                                                                    name: i [4276,4277]
                                                                    operator: + [4278,4279]
                                                                    literal: 1 [4280,4281]
                                                            condition [4284,4297]
                                                                expr [4284,4296]
                                                                    name: k [4284,4285]
                                                                    operator: < [4286,4287]
                                                                    name: NOFFSETS [4288,4296]
                                                            incr [4298,4301]
                                                                expr [4298,4301]
                                                                    name: k [4298,4299]
                                                                    operator: ++ [4299,4301]
                                                        block [4303,4577]
                                                            block_content [4310,4571]
                                                                decl_stmt [4310,4320]
                                                                    decl [4310,4319]
                                                                        type [4310,4316]
                                                                            name: size_t [4310,4316]
                                                                        name: no [4317,4319]
                                                                decl_stmt [4326,4341]
                                                                    decl [4326,4340]
                                                                        type [4326,4329]
                                                                            name: int [4326,4329]
                                                                        name: adjust [4330,4336]
                                                                        init [4337,4340]
                                                                            expr [4339,4340]
                                                                                literal: 1 [4339,4340]
                                                                if_stmt [4347,4400]
                                                                    if [4347,4400]
                                                                        condition [4350,4384]
                                                                            expr [4351,4383]
                                                                                call [4351,4365]
                                                                                    name: prpsoffsets [4351,4362]
                                                                                    argument_list [4362,4365]
                                                                                        argument [4363,4364]
                                                                                            expr [4363,4364]
                                                                                                name: k [4363,4364]
                                                                                operator: >= [4366,4368]
                                                                                call [4369,4383]
                                                                                    name: prpsoffsets [4369,4380]
                                                                                    argument_list [4380,4383]
                                                                                        argument [4381,4382]
                                                                                            expr [4381,4382]
                                                                                                name: i [4381,4382]
                                                                        block [4391,4400]
                                                                            block_content [4391,4400]
                                                                                continue [4391,4400]
                                                                for [4406,4541]
                                                                    control [4410,4482]
                                                                        init [4411,4438]
                                                                            expr [4411,4437]
                                                                                name: no [4411,4413]
                                                                                operator: = [4414,4415]
                                                                                name: doff [4416,4420]
                                                                                operator: + [4421,4422]
                                                                                call [4423,4437]
                                                                                    name: prpsoffsets [4423,4434]
                                                                                    argument_list [4434,4437]
                                                                                        argument [4435,4436]
                                                                                            expr [4435,4436]
                                                                                                name: k [4435,4436]
                                                                        condition [4449,4476]
                                                                            expr [4449,4475]
                                                                                name: no [4449,4451]
                                                                                operator: < [4452,4453]
                                                                                name: doff [4454,4458]
                                                                                operator: + [4459,4460]
                                                                                call [4461,4475]
                                                                                    name: prpsoffsets [4461,4472]
                                                                                    argument_list [4472,4475]
                                                                                        argument [4473,4474]
                                                                                            expr [4473,4474]
                                                                                                name: i [4473,4474]
                                                                        incr [4477,4481]
                                                                            expr [4477,4481]
                                                                                name: no [4477,4479]
                                                                                operator: ++ [4479,4481]
                                                                    block [4489,4541]
                                                                        block_content [4489,4541]
                                                                            expr_stmt [4489,4541]
                                                                                expr [4489,4540]
                                                                                    name: adjust [4489,4495]
                                                                                    operator: = [4496,4497]
                                                                                    name: adjust [4498,4504]
                                                                                    operator: && [4520,4522]
                                                                                    call [4523,4540]
                                                                                        name: isprint [4523,4530]
                                                                                        argument_list [4530,4540]
                                                                                            argument [4531,4539]
                                                                                                expr [4531,4539]
                                                                                                    name [4531,4539]
                                                                                                        name: nbuf [4531,4535]
                                                                                                        index [4535,4539]
                                                                                                            expr [4536,4538]
                                                                                                                name: no [4536,4538]
                                                                if_stmt [4547,4571]
                                                                    if [4547,4571]
                                                                        condition [4550,4558]
                                                                            expr [4551,4557]
                                                                                name: adjust [4551,4557]
                                                                        block [4565,4571]
                                                                            block_content [4565,4571]
                                                                                expr_stmt [4565,4571]
                                                                                    expr [4565,4570]
                                                                                        name: i [4565,4566]
                                                                                        operator: = [4567,4568]
                                                                                        name: k [4569,4570]
                                                    expr_stmt [4583,4646]
                                                        expr [4583,4645]
                                                            name: cname [4583,4588]
                                                            operator: = [4589,4590]
                                                            operator: ( [4591,4592]
                                                            name: unsigned [4592,4600]
                                                            name: char [4601,4605]
                                                            operator: * [4606,4607]
                                                            operator: ) [4607,4608]
                                                            operator: & [4617,4618]
                                                            name [4618,4645]
                                                                name: nbuf [4618,4622]
                                                                index [4622,4645]
                                                                    expr [4623,4644]
                                                                        name: doff [4623,4627]
                                                                        operator: + [4628,4629]
                                                                        call [4630,4644]
                                                                            name: prpsoffsets [4630,4641]
                                                                            argument_list [4641,4644]
                                                                                argument [4642,4643]
                                                                                    expr [4642,4643]
                                                                                        name: i [4642,4643]
                                                    for [4651,4737]
                                                        control [4655,4722]
                                                            init [4656,4667]
                                                                expr [4656,4666]
                                                                    name: cp [4656,4658]
                                                                    operator: = [4659,4660]
                                                                    name: cname [4661,4666]
                                                            condition [4668,4716]
                                                                expr [4668,4715]
                                                                    name: cp [4668,4670]
                                                                    operator: < [4671,4672]
                                                                    name: nbuf [4673,4677]
                                                                    operator: + [4678,4679]
                                                                    name: size [4680,4684]
                                                                    operator: && [4685,4687]
                                                                    operator: * [4688,4689]
                                                                    name: cp [4689,4691]
                                                                    operator: && [4700,4702]
                                                                    call [4703,4715]
                                                                        name: isprint [4703,4710]
                                                                        argument_list [4710,4715]
                                                                            argument [4711,4714]
                                                                                expr [4711,4714]
                                                                                    operator: * [4711,4712]
                                                                                    name: cp [4712,4714]
                                                            incr [4717,4721]
                                                                expr [4717,4721]
                                                                    name: cp [4717,4719]
                                                                    operator: ++ [4719,4721]
                                                        block [4728,4737]
                                                            block_content [4728,4737]
                                                                continue [4728,4737]
                                                    comment: /*
				 * Linux apparently appends a space at the end* of the command line: remove it.
				 */ [4742,4870]
                                                    while [4847,4895]
                                                        condition [4853,4884]
                                                            expr [4854,4883]
                                                                name: cp [4854,4856]
                                                                operator: > [4857,4858]
                                                                name: cname [4859,4864]
                                                                operator: && [4865,4867]
                                                                call [4868,4883]
                                                                    name: isspace [4868,4875]
                                                                    argument_list [4875,4883]
                                                                        argument [4876,4882]
                                                                            expr [4876,4882]
                                                                                name [4876,4882]
                                                                                    name: cp [4876,4878]
                                                                                    index [4878,4882]
                                                                                        expr [4879,4881]
                                                                                            operator: - [4879,4880]
                                                                                            literal: 1 [4880,4881]
                                                        block [4890,4895]
                                                            block_content [4890,4895]
                                                                expr_stmt [4890,4895]
                                                                    expr [4890,4894]
                                                                        name: cp [4890,4892]
                                                                        operator: -- [4892,4894]
                                                    if_stmt [4900,4992]
                                                        if [4900,4992]
                                                            condition [4903,4977]
                                                                expr [4904,4976]
                                                                    call [4904,4970]
                                                                        name: file_printf [4904,4915]
                                                                        argument_list [4915,4970]
                                                                            argument [4916,4918]
                                                                                expr [4916,4918]
                                                                                    name: ms [4916,4918]
                                                                            argument [4920,4935]
                                                                                expr [4920,4935]
                                                                                    literal: ", from '%.*s'" [4920,4935]
                                                                            argument [4945,4962]
                                                                                expr [4945,4962]
                                                                                    operator: ( [4945,4946]
                                                                                    name: int [4946,4949]
                                                                                    operator: ) [4949,4950]
                                                                                    operator: ( [4950,4951]
                                                                                    name: cp [4951,4953]
                                                                                    operator: - [4954,4955]
                                                                                    name: cname [4956,4961]
                                                                                    operator: ) [4961,4962]
                                                                            argument [4964,4969]
                                                                                expr [4964,4969]
                                                                                    name: cname [4964,4969]
                                                                    operator: == [4971,4973]
                                                                    operator: - [4974,4975]
                                                                    literal: 1 [4975,4976]
                                                            block [4983,4992]
                                                                block_content [4983,4992]
                                                                    return [4983,4992]
                                                                        expr [4990,4991]
                                                                            literal: 1 [4990,4991]
                                                    expr_stmt [4997,5022]
                                                        expr [4997,5021]
                                                            operator: * [4997,4998]
                                                            name: flags [4998,5003]
                                                            operator: |= [5004,5006]
                                                            name: FLAGS_DID_CORE [5007,5021]
                                                    return [5027,5036]
                                                        expr [5034,5035]
                                                            literal: 1 [5034,5035]
                                                    label [5041,5052]
                                                        name: tryanother [5041,5051]
                                                    empty_stmt [5057,5058]
                        break [5070,5076]
            endif [5080,5086]
                directive: endif [5081,5086]
            return [5088,5097]
                expr [5095,5096]
                    literal: 0 [5095,5096]