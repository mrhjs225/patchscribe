unit [0,0]
    function [0,2583]
        type [0,10]
            specifier: static [0,6]
            name: int [7,10]
        name: tomoyo_mount_acl [11,27]
        parameter_list [27,132]
            parameter [28,57]
                decl [28,57]
                    type [28,57]
                        name [28,54]
                            name: struct [28,34]
                            name: tomoyo_request_info [35,54]
                        modifier: * [55,56]
                    name: r [56,57]
            parameter [59,73]
                decl [59,73]
                    type [59,73]
                        name: char [59,63]
                        modifier: * [64,65]
                    name: dev_name [65,73]
            parameter [82,98]
                decl [82,98]
                    type [82,98]
                        name [82,93]
                            name: struct [82,88]
                            name: path [89,93]
                        modifier: * [94,95]
                    name: dir [95,98]
            parameter [100,110]
                decl [100,110]
                    type [100,110]
                        name: char [100,104]
                        modifier: * [105,106]
                    name: type [106,110]
            parameter [112,131]
                decl [112,131]
                    type [112,131]
                        name: unsigned [112,120]
                        name: long [121,125]
                    name: flags [126,131]
        block [133,2583]
            block_content [136,2581]
                decl_stmt [136,153]
                    decl [136,152]
                        type [136,147]
                            name [136,147]
                                name: struct [136,142]
                                name: path [143,147]
                        name: path [148,152]
                decl_stmt [155,194]
                    decl [155,193]
                        type [155,180]
                            name [155,178]
                                name: struct [155,161]
                                name: file_system_type [162,178]
                            modifier: * [179,180]
                        name: fstype [180,186]
                        init [187,193]
                            expr [189,193]
                                name: NULL [189,193]
                decl_stmt [196,230]
                    decl [196,229]
                        type [196,208]
                            specifier: const [196,201]
                            name: char [202,206]
                            modifier: * [207,208]
                        name: requested_type [208,222]
                        init [223,229]
                            expr [225,229]
                                name: NULL [225,229]
                decl_stmt [232,270]
                    decl [232,269]
                        type [232,244]
                            specifier: const [232,237]
                            name: char [238,242]
                            modifier: * [243,244]
                        name: requested_dir_name [244,262]
                        init [263,269]
                            expr [265,269]
                                name: NULL [265,269]
                decl_stmt [272,310]
                    decl [272,309]
                        type [272,284]
                            specifier: const [272,277]
                            name: char [278,282]
                            modifier: * [283,284]
                        name: requested_dev_name [284,302]
                        init [303,309]
                            expr [305,309]
                                name: NULL [305,309]
                decl_stmt [312,342]
                    decl [312,341]
                        type [312,335]
                            name [312,335]
                                name: struct [312,318]
                                name: tomoyo_path_info [319,335]
                        name: rtype [336,341]
                decl_stmt [344,373]
                    decl [344,372]
                        type [344,367]
                            name [344,367]
                                name: struct [344,350]
                                name: tomoyo_path_info [351,367]
                        name: rdev [368,372]
                decl_stmt [375,404]
                    decl [375,403]
                        type [375,398]
                            name [375,398]
                                name: struct [375,381]
                                name: tomoyo_path_info [382,398]
                        name: rdir [399,403]
                decl_stmt [406,423]
                    decl [406,422]
                        type [406,409]
                            name: int [406,409]
                        name: need_dev [410,418]
                        init [419,422]
                            expr [421,422]
                                literal: 0 [421,422]
                decl_stmt [425,445]
                    decl [425,444]
                        type [425,428]
                            name: int [425,428]
                        name: error [429,434]
                        init [435,444]
                            expr [437,444]
                                operator: - [437,438]
                                name: ENOMEM [438,444]
                comment: /* Get fstype. */ [448,465]
                expr_stmt [467,504]
                    expr [467,503]
                        name: requested_type [467,481]
                        operator: = [482,483]
                        call [484,503]
                            name: tomoyo_encode [484,497]
                            argument_list [497,503]
                                argument [498,502]
                                    expr [498,502]
                                        name: type [498,502]
                if_stmt [506,538]
                    if [506,538]
                        condition [509,526]
                            expr [510,525]
                                operator: ! [510,511]
                                name: requested_type [511,525]
                        block [529,538]
                            block_content [529,538]
                                goto [529,538]
                                    name: out [534,537]
                expr_stmt [540,568]
                    expr [540,567]
                        name [540,550]
                            name: rtype [540,545]
                            operator: . [545,546]
                            name: name [546,550]
                        operator: = [551,552]
                        name: requested_type [553,567]
                expr_stmt [570,600]
                    expr [570,599]
                        call [570,599]
                            name: tomoyo_fill_path_info [570,591]
                            argument_list [591,599]
                                argument [592,598]
                                    expr [592,598]
                                        operator: & [592,593]
                                        name: rtype [593,598]
                comment: /* Get mount point. */ [603,625]
                expr_stmt [627,679]
                    expr [627,678]
                        name: requested_dir_name [627,645]
                        operator: = [646,647]
                        call [648,678]
                            name: tomoyo_realpath_from_path [648,673]
                            argument_list [673,678]
                                argument [674,677]
                                    expr [674,677]
                                        name: dir [674,677]
                if_stmt [681,741]
                    if [681,741]
                        condition [684,705]
                            expr [685,704]
                                operator: ! [685,686]
                                name: requested_dir_name [686,704]
                        block [706,741]
                            block_content [710,738]
                                expr_stmt [710,726]
                                    expr [710,725]
                                        name: error [710,715]
                                        operator: = [716,717]
                                        operator: - [718,719]
                                        name: ENOMEM [719,725]
                                goto [729,738]
                                    name: out [734,737]
                expr_stmt [743,774]
                    expr [743,773]
                        name [743,752]
                            name: rdir [743,747]
                            operator: . [747,748]
                            name: name [748,752]
                        operator: = [753,754]
                        name: requested_dir_name [755,773]
                expr_stmt [776,805]
                    expr [776,804]
                        call [776,804]
                            name: tomoyo_fill_path_info [776,797]
                            argument_list [797,804]
                                argument [798,803]
                                    expr [798,803]
                                        operator: & [798,799]
                                        name: rdir [799,803]
                comment: /* Compare fs name. */ [808,830]
                if_stmt [832,1525]
                    if [832,914]
                        condition [835,880]
                            expr [836,879]
                                operator: ! [836,837]
                                call [837,879]
                                    name: strcmp [837,843]
                                    argument_list [843,879]
                                        argument [844,848]
                                            expr [844,848]
                                                name: type [844,848]
                                        argument [850,878]
                                            expr [850,878]
                                                name: TOMOYO_MOUNT_REMOUNT_KEYWORD [850,878]
                        block [881,914]
                            block_content [0,0]
                                comment: /* dev_name is ignored. */ [885,911]
                    if [915,1178]
                        condition [923,1144]
                            expr [924,1143]
                                operator: ! [924,925]
                                call [925,975]
                                    name: strcmp [925,931]
                                    argument_list [931,975]
                                        argument [932,936]
                                            expr [932,936]
                                                name: type [932,936]
                                        argument [938,974]
                                            expr [938,974]
                                                name: TOMOYO_MOUNT_MAKE_UNBINDABLE_KEYWORD [938,974]
                                operator: || [976,978]
                                operator: ! [984,985]
                                call [985,1032]
                                    name: strcmp [985,991]
                                    argument_list [991,1032]
                                        argument [992,996]
                                            expr [992,996]
                                                name: type [992,996]
                                        argument [998,1031]
                                            expr [998,1031]
                                                name: TOMOYO_MOUNT_MAKE_PRIVATE_KEYWORD [998,1031]
                                operator: || [1033,1035]
                                operator: ! [1041,1042]
                                call [1042,1087]
                                    name: strcmp [1042,1048]
                                    argument_list [1048,1087]
                                        argument [1049,1053]
                                            expr [1049,1053]
                                                name: type [1049,1053]
                                        argument [1055,1086]
                                            expr [1055,1086]
                                                name: TOMOYO_MOUNT_MAKE_SLAVE_KEYWORD [1055,1086]
                                operator: || [1088,1090]
                                operator: ! [1096,1097]
                                call [1097,1143]
                                    name: strcmp [1097,1103]
                                    argument_list [1103,1143]
                                        argument [1104,1108]
                                            expr [1104,1108]
                                                name: type [1104,1108]
                                        argument [1110,1142]
                                            expr [1110,1142]
                                                name: TOMOYO_MOUNT_MAKE_SHARED_KEYWORD [1110,1142]
                        block [1145,1178]
                            block_content [0,0]
                                comment: /* dev_name is ignored. */ [1149,1175]
                    if [1179,1330]
                        condition [1187,1278]
                            expr [1188,1277]
                                operator: ! [1188,1189]
                                call [1189,1228]
                                    name: strcmp [1189,1195]
                                    argument_list [1195,1228]
                                        argument [1196,1200]
                                            expr [1196,1200]
                                                name: type [1196,1200]
                                        argument [1202,1227]
                                            expr [1202,1227]
                                                name: TOMOYO_MOUNT_BIND_KEYWORD [1202,1227]
                                operator: || [1229,1231]
                                operator: ! [1237,1238]
                                call [1238,1277]
                                    name: strcmp [1238,1244]
                                    argument_list [1244,1277]
                                        argument [1245,1249]
                                            expr [1245,1249]
                                                name: type [1245,1249]
                                        argument [1251,1276]
                                            expr [1251,1276]
                                                name: TOMOYO_MOUNT_MOVE_KEYWORD [1251,1276]
                        block [1279,1330]
                            block_content [1283,1297]
                                expr_stmt [1283,1297]
                                    expr [1283,1296]
                                        name: need_dev [1283,1291]
                                        operator: = [1292,1293]
                                        operator: - [1294,1295]
                                        literal: 1 [1295,1296]
                                comment: /* dev_name is a directory */ [1298,1327]
                    else [1331,1525]
                        block [1336,1525]
                            block_content [1340,1522]
                                expr_stmt [1340,1367]
                                    expr [1340,1366]
                                        name: fstype [1340,1346]
                                        operator: = [1347,1348]
                                        call [1349,1366]
                                            name: get_fs_type [1349,1360]
                                            argument_list [1360,1366]
                                                argument [1361,1365]
                                                    expr [1361,1365]
                                                        name: type [1361,1365]
                                if_stmt [1370,1421]
                                    if [1370,1421]
                                        condition [1373,1382]
                                            expr [1374,1381]
                                                operator: ! [1374,1375]
                                                name: fstype [1375,1381]
                                        block [1383,1421]
                                            block_content [1388,1417]
                                                expr_stmt [1388,1404]
                                                    expr [1388,1403]
                                                        name: error [1388,1393]
                                                        operator: = [1394,1395]
                                                        operator: - [1396,1397]
                                                        name: ENODEV [1397,1403]
                                                goto [1408,1417]
                                                    name: out [1413,1416]
                                if_stmt [1424,1522]
                                    if [1424,1522]
                                        condition [1427,1463]
                                            expr [1428,1462]
                                                name [1428,1444]
                                                    name: fstype [1428,1434]
                                                    operator: -> [1434,1436]
                                                    name: fs_flags [1436,1444]
                                                operator: & [1445,1446]
                                                name: FS_REQUIRES_DEV [1447,1462]
                                        block [1509,1522]
                                            block_content [1509,1522]
                                                comment: /* dev_name is a block device file. */ [1467,1505]
                                                expr_stmt [1509,1522]
                                                    expr [1509,1521]
                                                        name: need_dev [1509,1517]
                                                        operator: = [1518,1519]
                                                        literal: 1 [1520,1521]
                if_stmt [1527,2048]
                    if [1527,1828]
                        condition [1530,1540]
                            expr [1531,1539]
                                name: need_dev [1531,1539]
                        block [1541,1828]
                            block_content [1585,1825]
                                comment: /* Get mount point or device file. */ [1545,1582]
                                if_stmt [1585,1683]
                                    if [1585,1683]
                                        condition [1588,1644]
                                            expr [1589,1643]
                                                operator: ! [1589,1590]
                                                name: dev_name [1590,1598]
                                                operator: || [1599,1601]
                                                call [1602,1643]
                                                    name: kern_path [1602,1611]
                                                    argument_list [1611,1643]
                                                        argument [1612,1620]
                                                            expr [1612,1620]
                                                                name: dev_name [1612,1620]
                                                        argument [1622,1635]
                                                            expr [1622,1635]
                                                                name: LOOKUP_FOLLOW [1622,1635]
                                                        argument [1637,1642]
                                                            expr [1637,1642]
                                                                operator: & [1637,1638]
                                                                name: path [1638,1642]
                                        block [1645,1683]
                                            block_content [1650,1679]
                                                expr_stmt [1650,1666]
                                                    expr [1650,1665]
                                                        name: error [1650,1655]
                                                        operator: = [1656,1657]
                                                        operator: - [1658,1659]
                                                        name: ENOENT [1659,1665]
                                                goto [1670,1679]
                                                    name: out [1675,1678]
                                expr_stmt [1686,1740]
                                    expr [1686,1739]
                                        name: requested_dev_name [1686,1704]
                                        operator: = [1705,1706]
                                        call [1707,1739]
                                            name: tomoyo_realpath_from_path [1707,1732]
                                            argument_list [1732,1739]
                                                argument [1733,1738]
                                                    expr [1733,1738]
                                                        operator: & [1733,1734]
                                                        name: path [1734,1738]
                                expr_stmt [1743,1759]
                                    expr [1743,1758]
                                        call [1743,1758]
                                            name: path_put [1743,1751]
                                            argument_list [1751,1758]
                                                argument [1752,1757]
                                                    expr [1752,1757]
                                                        operator: & [1752,1753]
                                                        name: path [1753,1757]
                                if_stmt [1762,1825]
                                    if [1762,1825]
                                        condition [1765,1786]
                                            expr [1766,1785]
                                                operator: ! [1766,1767]
                                                name: requested_dev_name [1767,1785]
                                        block [1787,1825]
                                            block_content [1792,1821]
                                                expr_stmt [1792,1808]
                                                    expr [1792,1807]
                                                        name: error [1792,1797]
                                                        operator: = [1798,1799]
                                                        operator: - [1800,1801]
                                                        name: ENOENT [1801,1807]
                                                goto [1812,1821]
                                                    name: out [1817,1820]
                    else [1829,2048]
                        block [1834,2048]
                            block_content [1893,2045]
                                comment: /* Map dev_name to "<NULL>" if no dev_name given. */ [1838,1890]
                                if_stmt [1893,1931]
                                    if [1893,1931]
                                        condition [1896,1907]
                                            expr [1897,1906]
                                                operator: ! [1897,1898]
                                                name: dev_name [1898,1906]
                                        block [1911,1931]
                                            block_content [1911,1931]
                                                expr_stmt [1911,1931]
                                                    expr [1911,1930]
                                                        name: dev_name [1911,1919]
                                                        operator: = [1920,1921]
                                                        literal: "<NULL>" [1922,1930]
                                expr_stmt [1934,1979]
                                    expr [1934,1978]
                                        name: requested_dev_name [1934,1952]
                                        operator: = [1953,1954]
                                        call [1955,1978]
                                            name: tomoyo_encode [1955,1968]
                                            argument_list [1968,1978]
                                                argument [1969,1977]
                                                    expr [1969,1977]
                                                        name: dev_name [1969,1977]
                                if_stmt [1982,2045]
                                    if [1982,2045]
                                        condition [1985,2006]
                                            expr [1986,2005]
                                                operator: ! [1986,1987]
                                                name: requested_dev_name [1987,2005]
                                        block [2007,2045]
                                            block_content [2012,2041]
                                                expr_stmt [2012,2028]
                                                    expr [2012,2027]
                                                        name: error [2012,2017]
                                                        operator: = [2018,2019]
                                                        operator: - [2020,2021]
                                                        name: ENOMEM [2021,2027]
                                                goto [2032,2041]
                                                    name: out [2037,2040]
                expr_stmt [2050,2081]
                    expr [2050,2080]
                        name [2050,2059]
                            name: rdev [2050,2054]
                            operator: . [2054,2055]
                            name: name [2055,2059]
                        operator: = [2060,2061]
                        name: requested_dev_name [2062,2080]
                expr_stmt [2083,2112]
                    expr [2083,2111]
                        call [2083,2111]
                            name: tomoyo_fill_path_info [2083,2104]
                            argument_list [2104,2111]
                                argument [2105,2110]
                                    expr [2105,2110]
                                        operator: & [2105,2106]
                                        name: rdev [2106,2110]
                expr_stmt [2114,2152]
                    expr [2114,2151]
                        name [2114,2127]
                            name: r [2114,2115]
                            operator: -> [2115,2117]
                            name: param_type [2117,2127]
                        operator: = [2128,2129]
                        name: TOMOYO_TYPE_MOUNT_ACL [2130,2151]
                expr_stmt [2154,2189]
                    expr [2154,2188]
                        name [2154,2177]
                            name: r [2154,2155]
                            operator: -> [2155,2157]
                            name: param [2157,2162]
                            operator: . [2162,2163]
                            name: mount [2163,2168]
                            operator: . [2168,2169]
                            name: need_dev [2169,2177]
                        operator: = [2178,2179]
                        name: need_dev [2180,2188]
                expr_stmt [2191,2218]
                    expr [2191,2217]
                        name [2191,2209]
                            name: r [2191,2192]
                            operator: -> [2192,2194]
                            name: param [2194,2199]
                            operator: . [2199,2200]
                            name: mount [2200,2205]
                            operator: . [2205,2206]
                            name: dev [2206,2209]
                        operator: = [2210,2211]
                        operator: & [2212,2213]
                        name: rdev [2213,2217]
                expr_stmt [2220,2247]
                    expr [2220,2246]
                        name [2220,2238]
                            name: r [2220,2221]
                            operator: -> [2221,2223]
                            name: param [2223,2228]
                            operator: . [2228,2229]
                            name: mount [2229,2234]
                            operator: . [2234,2235]
                            name: dir [2235,2238]
                        operator: = [2239,2240]
                        operator: & [2241,2242]
                        name: rdir [2242,2246]
                expr_stmt [2249,2278]
                    expr [2249,2277]
                        name [2249,2268]
                            name: r [2249,2250]
                            operator: -> [2250,2252]
                            name: param [2252,2257]
                            operator: . [2257,2258]
                            name: mount [2258,2263]
                            operator: . [2263,2264]
                            name: type [2264,2268]
                        operator: = [2269,2270]
                        operator: & [2271,2272]
                        name: rtype [2272,2277]
                expr_stmt [2280,2309]
                    expr [2280,2308]
                        name [2280,2300]
                            name: r [2280,2281]
                            operator: -> [2281,2283]
                            name: param [2283,2288]
                            operator: . [2288,2289]
                            name: mount [2289,2294]
                            operator: . [2294,2295]
                            name: flags [2295,2300]
                        operator: = [2301,2302]
                        name: flags [2303,2308]
                do [2311,2441]
                    block [2314,2402]
                        block_content [2318,2399]
                            expr_stmt [2318,2362]
                                expr [2318,2361]
                                    call [2318,2361]
                                        name: tomoyo_check_acl [2318,2334]
                                        argument_list [2334,2361]
                                            argument [2335,2336]
                                                expr [2335,2336]
                                                    name: r [2335,2336]
                                            argument [2338,2360]
                                                expr [2338,2360]
                                                    name: tomoyo_check_mount_acl [2338,2360]
                            expr_stmt [2365,2399]
                                expr [2365,2398]
                                    name: error [2365,2370]
                                    operator: = [2371,2372]
                                    call [2373,2398]
                                        name: tomoyo_audit_mount_log [2373,2395]
                                        argument_list [2395,2398]
                                            argument [2396,2397]
                                                expr [2396,2397]
                                                    name: r [2396,2397]
                    condition [2409,2440]
                        expr [2410,2439]
                            name: error [2410,2415]
                            operator: == [2416,2418]
                            name: TOMOYO_RETRY_REQUEST [2419,2439]
                label [2443,2447]
                    name: out [2443,2446]
                expr_stmt [2449,2475]
                    expr [2449,2474]
                        call [2449,2474]
                            name: kfree [2449,2454]
                            argument_list [2454,2474]
                                argument [2455,2473]
                                    expr [2455,2473]
                                        name: requested_dev_name [2455,2473]
                expr_stmt [2477,2503]
                    expr [2477,2502]
                        call [2477,2502]
                            name: kfree [2477,2482]
                            argument_list [2482,2502]
                                argument [2483,2501]
                                    expr [2483,2501]
                                        name: requested_dir_name [2483,2501]
                if_stmt [2505,2542]
                    if [2505,2542]
                        condition [2508,2516]
                            expr [2509,2515]
                                name: fstype [2509,2515]
                        block [2519,2542]
                            block_content [2519,2542]
                                expr_stmt [2519,2542]
                                    expr [2519,2541]
                                        call [2519,2541]
                                            name: put_filesystem [2519,2533]
                                            argument_list [2533,2541]
                                                argument [2534,2540]
                                                    expr [2534,2540]
                                                        name: fstype [2534,2540]
                expr_stmt [2544,2566]
                    expr [2544,2565]
                        call [2544,2565]
                            name: kfree [2544,2549]
                            argument_list [2549,2565]
                                argument [2550,2564]
                                    expr [2550,2564]
                                        name: requested_type [2550,2564]
                return [2568,2581]
                    expr [2575,2580]
                        name: error [2575,2580]