unit [0,0]
    function [0,2570]
        type [0,10]
            specifier: static [0,6]
            name: int [7,10]
        name: tomoyo_mount_acl [11,27]
        parameter_list [27,132]
            parameter [28,57]
                decl [28,57]
                    type [28,57]
                        name [28,54]
                            name: struct [28,34]
                            name: tomoyo_request_info [35,54]
                        modifier: * [55,56]
                    name: r [56,57]
            parameter [59,73]
                decl [59,73]
                    type [59,73]
                        name: char [59,63]
                        modifier: * [64,65]
                    name: dev_name [65,73]
            parameter [82,98]
                decl [82,98]
                    type [82,98]
                        name [82,93]
                            name: struct [82,88]
                            name: path [89,93]
                        modifier: * [94,95]
                    name: dir [95,98]
            parameter [100,110]
                decl [100,110]
                    type [100,110]
                        name: char [100,104]
                        modifier: * [105,106]
                    name: type [106,110]
            parameter [112,131]
                decl [112,131]
                    type [112,131]
                        name: unsigned [112,120]
                        name: long [121,125]
                    name: flags [126,131]
        block [133,2570]
            block_content [136,2568]
                decl_stmt [136,153]
                    decl [136,152]
                        type [136,147]
                            name [136,147]
                                name: struct [136,142]
                                name: path [143,147]
                        name: path [148,152]
                decl_stmt [155,194]
                    decl [155,193]
                        type [155,180]
                            name [155,178]
                                name: struct [155,161]
                                name: file_system_type [162,178]
                            modifier: * [179,180]
                        name: fstype [180,186]
                        init [187,193]
                            expr [189,193]
                                name: NULL [189,193]
                decl_stmt [196,230]
                    decl [196,229]
                        type [196,208]
                            specifier: const [196,201]
                            name: char [202,206]
                            modifier: * [207,208]
                        name: requested_type [208,222]
                        init [223,229]
                            expr [225,229]
                                name: NULL [225,229]
                decl_stmt [232,270]
                    decl [232,269]
                        type [232,244]
                            specifier: const [232,237]
                            name: char [238,242]
                            modifier: * [243,244]
                        name: requested_dir_name [244,262]
                        init [263,269]
                            expr [265,269]
                                name: NULL [265,269]
                decl_stmt [272,310]
                    decl [272,309]
                        type [272,284]
                            specifier: const [272,277]
                            name: char [278,282]
                            modifier: * [283,284]
                        name: requested_dev_name [284,302]
                        init [303,309]
                            expr [305,309]
                                name: NULL [305,309]
                decl_stmt [312,342]
                    decl [312,341]
                        type [312,335]
                            name [312,335]
                                name: struct [312,318]
                                name: tomoyo_path_info [319,335]
                        name: rtype [336,341]
                decl_stmt [344,373]
                    decl [344,372]
                        type [344,367]
                            name [344,367]
                                name: struct [344,350]
                                name: tomoyo_path_info [351,367]
                        name: rdev [368,372]
                decl_stmt [375,404]
                    decl [375,403]
                        type [375,398]
                            name [375,398]
                                name: struct [375,381]
                                name: tomoyo_path_info [382,398]
                        name: rdir [399,403]
                decl_stmt [406,423]
                    decl [406,422]
                        type [406,409]
                            name: int [406,409]
                        name: need_dev [410,418]
                        init [419,422]
                            expr [421,422]
                                literal: 0 [421,422]
                decl_stmt [425,445]
                    decl [425,444]
                        type [425,428]
                            name: int [425,428]
                        name: error [429,434]
                        init [435,444]
                            expr [437,444]
                                operator: - [437,438]
                                name: ENOMEM [438,444]
                comment: /* Get fstype. */ [448,465]
                expr_stmt [467,504]
                    expr [467,503]
                        name: requested_type [467,481]
                        operator: = [482,483]
                        call [484,503]
                            name: tomoyo_encode [484,497]
                            argument_list [497,503]
                                argument [498,502]
                                    expr [498,502]
                                        name: type [498,502]
                if_stmt [506,538]
                    if [506,538]
                        condition [509,526]
                            expr [510,525]
                                operator: ! [510,511]
                                name: requested_type [511,525]
                        block [529,538]
                            block_content [529,538]
                                goto [529,538]
                                    name: out [534,537]
                expr_stmt [540,568]
                    expr [540,567]
                        name [540,550]
                            name: rtype [540,545]
                            operator: . [545,546]
                            name: name [546,550]
                        operator: = [551,552]
                        name: requested_type [553,567]
                expr_stmt [570,600]
                    expr [570,599]
                        call [570,599]
                            name: tomoyo_fill_path_info [570,591]
                            argument_list [591,599]
                                argument [592,598]
                                    expr [592,598]
                                        operator: & [592,593]
                                        name: rtype [593,598]
                comment: /* Get mount point. */ [603,625]
                expr_stmt [627,679]
                    expr [627,678]
                        name: requested_dir_name [627,645]
                        operator: = [646,647]
                        call [648,678]
                            name: tomoyo_realpath_from_path [648,673]
                            argument_list [673,678]
                                argument [674,677]
                                    expr [674,677]
                                        name: dir [674,677]
                if_stmt [681,741]
                    if [681,741]
                        condition [684,705]
                            expr [685,704]
                                operator: ! [685,686]
                                name: requested_dir_name [686,704]
                        block [706,741]
                            block_content [710,738]
                                expr_stmt [710,726]
                                    expr [710,725]
                                        name: error [710,715]
                                        operator: = [716,717]
                                        operator: - [718,719]
                                        name: ENOMEM [719,725]
                                goto [729,738]
                                    name: out [734,737]
                expr_stmt [743,774]
                    expr [743,773]
                        name [743,752]
                            name: rdir [743,747]
                            operator: . [747,748]
                            name: name [748,752]
                        operator: = [753,754]
                        name: requested_dir_name [755,773]
                expr_stmt [776,805]
                    expr [776,804]
                        call [776,804]
                            name: tomoyo_fill_path_info [776,797]
                            argument_list [797,804]
                                argument [798,803]
                                    expr [798,803]
                                        operator: & [798,799]
                                        name: rdir [799,803]
                comment: /* Compare fs name. */ [808,830]
                if_stmt [832,1525]
                    if [832,914]
                        condition [835,880]
                            expr [836,879]
                                operator: ! [836,837]
                                call [837,879]
                                    name: strcmp [837,843]
                                    argument_list [843,879]
                                        argument [844,848]
                                            expr [844,848]
                                                name: type [844,848]
                                        argument [850,878]
                                            expr [850,878]
                                                name: TOMOYO_MOUNT_REMOUNT_KEYWORD [850,878]
                        block [881,914]
                            block_content [0,0]
                                comment: /* dev_name is ignored. */ [885,911]
                    if [915,1178]
                        condition [923,1144]
                            expr [924,1143]
                                operator: ! [924,925]
                                call [925,975]
                                    name: strcmp [925,931]
                                    argument_list [931,975]
                                        argument [932,936]
                                            expr [932,936]
                                                name: type [932,936]
                                        argument [938,974]
                                            expr [938,974]
                                                name: TOMOYO_MOUNT_MAKE_UNBINDABLE_KEYWORD [938,974]
                                operator: || [976,978]
                                operator: ! [984,985]
                                call [985,1032]
                                    name: strcmp [985,991]
                                    argument_list [991,1032]
                                        argument [992,996]
                                            expr [992,996]
                                                name: type [992,996]
                                        argument [998,1031]
                                            expr [998,1031]
                                                name: TOMOYO_MOUNT_MAKE_PRIVATE_KEYWORD [998,1031]
                                operator: || [1033,1035]
                                operator: ! [1041,1042]
                                call [1042,1087]
                                    name: strcmp [1042,1048]
                                    argument_list [1048,1087]
                                        argument [1049,1053]
                                            expr [1049,1053]
                                                name: type [1049,1053]
                                        argument [1055,1086]
                                            expr [1055,1086]
                                                name: TOMOYO_MOUNT_MAKE_SLAVE_KEYWORD [1055,1086]
                                operator: || [1088,1090]
                                operator: ! [1096,1097]
                                call [1097,1143]
                                    name: strcmp [1097,1103]
                                    argument_list [1103,1143]
                                        argument [1104,1108]
                                            expr [1104,1108]
                                                name: type [1104,1108]
                                        argument [1110,1142]
                                            expr [1110,1142]
                                                name: TOMOYO_MOUNT_MAKE_SHARED_KEYWORD [1110,1142]
                        block [1145,1178]
                            block_content [0,0]
                                comment: /* dev_name is ignored. */ [1149,1175]
                    if [1179,1330]
                        condition [1187,1278]
                            expr [1188,1277]
                                operator: ! [1188,1189]
                                call [1189,1228]
                                    name: strcmp [1189,1195]
                                    argument_list [1195,1228]
                                        argument [1196,1200]
                                            expr [1196,1200]
                                                name: type [1196,1200]
                                        argument [1202,1227]
                                            expr [1202,1227]
                                                name: TOMOYO_MOUNT_BIND_KEYWORD [1202,1227]
                                operator: || [1229,1231]
                                operator: ! [1237,1238]
                                call [1238,1277]
                                    name: strcmp [1238,1244]
                                    argument_list [1244,1277]
                                        argument [1245,1249]
                                            expr [1245,1249]
                                                name: type [1245,1249]
                                        argument [1251,1276]
                                            expr [1251,1276]
                                                name: TOMOYO_MOUNT_MOVE_KEYWORD [1251,1276]
                        block [1279,1330]
                            block_content [1283,1297]
                                expr_stmt [1283,1297]
                                    expr [1283,1296]
                                        name: need_dev [1283,1291]
                                        operator: = [1292,1293]
                                        operator: - [1294,1295]
                                        literal: 1 [1295,1296]
                                comment: /* dev_name is a directory */ [1298,1327]
                    else [1331,1525]
                        block [1336,1525]
                            block_content [1340,1522]
                                expr_stmt [1340,1367]
                                    expr [1340,1366]
                                        name: fstype [1340,1346]
                                        operator: = [1347,1348]
                                        call [1349,1366]
                                            name: get_fs_type [1349,1360]
                                            argument_list [1360,1366]
                                                argument [1361,1365]
                                                    expr [1361,1365]
                                                        name: type [1361,1365]
                                if_stmt [1370,1421]
                                    if [1370,1421]
                                        condition [1373,1382]
                                            expr [1374,1381]
                                                operator: ! [1374,1375]
                                                name: fstype [1375,1381]
                                        block [1383,1421]
                                            block_content [1388,1417]
                                                expr_stmt [1388,1404]
                                                    expr [1388,1403]
                                                        name: error [1388,1393]
                                                        operator: = [1394,1395]
                                                        operator: - [1396,1397]
                                                        name: ENODEV [1397,1403]
                                                goto [1408,1417]
                                                    name: out [1413,1416]
                                if_stmt [1424,1522]
                                    if [1424,1522]
                                        condition [1427,1463]
                                            expr [1428,1462]
                                                name [1428,1444]
                                                    name: fstype [1428,1434]
                                                    operator: -> [1434,1436]
                                                    name: fs_flags [1436,1444]
                                                operator: & [1445,1446]
                                                name: FS_REQUIRES_DEV [1447,1462]
                                        block [1509,1522]
                                            block_content [1509,1522]
                                                comment: /* dev_name is a block device file. */ [1467,1505]
                                                expr_stmt [1509,1522]
                                                    expr [1509,1521]
                                                        name: need_dev [1509,1517]
                                                        operator: = [1518,1519]
                                                        literal: 1 [1520,1521]
                if_stmt [1527,2035]
                    if [1527,1815]
                        condition [1530,1540]
                            expr [1531,1539]
                                name: need_dev [1531,1539]
                        block [1541,1815]
                            block_content [1585,1812]
                                comment: /* Get mount point or device file. */ [1545,1582]
                                if_stmt [1585,1670]
                                    if [1585,1670]
                                        condition [1588,1631]
                                            expr [1589,1630]
                                                call [1589,1630]
                                                    name: kern_path [1589,1598]
                                                    argument_list [1598,1630]
                                                        argument [1599,1607]
                                                            expr [1599,1607]
                                                                name: dev_name [1599,1607]
                                                        argument [1609,1622]
                                                            expr [1609,1622]
                                                                name: LOOKUP_FOLLOW [1609,1622]
                                                        argument [1624,1629]
                                                            expr [1624,1629]
                                                                operator: & [1624,1625]
                                                                name: path [1625,1629]
                                        block [1632,1670]
                                            block_content [1637,1666]
                                                expr_stmt [1637,1653]
                                                    expr [1637,1652]
                                                        name: error [1637,1642]
                                                        operator: = [1643,1644]
                                                        operator: - [1645,1646]
                                                        name: ENOENT [1646,1652]
                                                goto [1657,1666]
                                                    name: out [1662,1665]
                                expr_stmt [1673,1727]
                                    expr [1673,1726]
                                        name: requested_dev_name [1673,1691]
                                        operator: = [1692,1693]
                                        call [1694,1726]
                                            name: tomoyo_realpath_from_path [1694,1719]
                                            argument_list [1719,1726]
                                                argument [1720,1725]
                                                    expr [1720,1725]
                                                        operator: & [1720,1721]
                                                        name: path [1721,1725]
                                expr_stmt [1730,1746]
                                    expr [1730,1745]
                                        call [1730,1745]
                                            name: path_put [1730,1738]
                                            argument_list [1738,1745]
                                                argument [1739,1744]
                                                    expr [1739,1744]
                                                        operator: & [1739,1740]
                                                        name: path [1740,1744]
                                if_stmt [1749,1812]
                                    if [1749,1812]
                                        condition [1752,1773]
                                            expr [1753,1772]
                                                operator: ! [1753,1754]
                                                name: requested_dev_name [1754,1772]
                                        block [1774,1812]
                                            block_content [1779,1808]
                                                expr_stmt [1779,1795]
                                                    expr [1779,1794]
                                                        name: error [1779,1784]
                                                        operator: = [1785,1786]
                                                        operator: - [1787,1788]
                                                        name: ENOENT [1788,1794]
                                                goto [1799,1808]
                                                    name: out [1804,1807]
                    else [1816,2035]
                        block [1821,2035]
                            block_content [1880,2032]
                                comment: /* Map dev_name to "<NULL>" if no dev_name given. */ [1825,1877]
                                if_stmt [1880,1918]
                                    if [1880,1918]
                                        condition [1883,1894]
                                            expr [1884,1893]
                                                operator: ! [1884,1885]
                                                name: dev_name [1885,1893]
                                        block [1898,1918]
                                            block_content [1898,1918]
                                                expr_stmt [1898,1918]
                                                    expr [1898,1917]
                                                        name: dev_name [1898,1906]
                                                        operator: = [1907,1908]
                                                        literal: "<NULL>" [1909,1917]
                                expr_stmt [1921,1966]
                                    expr [1921,1965]
                                        name: requested_dev_name [1921,1939]
                                        operator: = [1940,1941]
                                        call [1942,1965]
                                            name: tomoyo_encode [1942,1955]
                                            argument_list [1955,1965]
                                                argument [1956,1964]
                                                    expr [1956,1964]
                                                        name: dev_name [1956,1964]
                                if_stmt [1969,2032]
                                    if [1969,2032]
                                        condition [1972,1993]
                                            expr [1973,1992]
                                                operator: ! [1973,1974]
                                                name: requested_dev_name [1974,1992]
                                        block [1994,2032]
                                            block_content [1999,2028]
                                                expr_stmt [1999,2015]
                                                    expr [1999,2014]
                                                        name: error [1999,2004]
                                                        operator: = [2005,2006]
                                                        operator: - [2007,2008]
                                                        name: ENOMEM [2008,2014]
                                                goto [2019,2028]
                                                    name: out [2024,2027]
                expr_stmt [2037,2068]
                    expr [2037,2067]
                        name [2037,2046]
                            name: rdev [2037,2041]
                            operator: . [2041,2042]
                            name: name [2042,2046]
                        operator: = [2047,2048]
                        name: requested_dev_name [2049,2067]
                expr_stmt [2070,2099]
                    expr [2070,2098]
                        call [2070,2098]
                            name: tomoyo_fill_path_info [2070,2091]
                            argument_list [2091,2098]
                                argument [2092,2097]
                                    expr [2092,2097]
                                        operator: & [2092,2093]
                                        name: rdev [2093,2097]
                expr_stmt [2101,2139]
                    expr [2101,2138]
                        name [2101,2114]
                            name: r [2101,2102]
                            operator: -> [2102,2104]
                            name: param_type [2104,2114]
                        operator: = [2115,2116]
                        name: TOMOYO_TYPE_MOUNT_ACL [2117,2138]
                expr_stmt [2141,2176]
                    expr [2141,2175]
                        name [2141,2164]
                            name: r [2141,2142]
                            operator: -> [2142,2144]
                            name: param [2144,2149]
                            operator: . [2149,2150]
                            name: mount [2150,2155]
                            operator: . [2155,2156]
                            name: need_dev [2156,2164]
                        operator: = [2165,2166]
                        name: need_dev [2167,2175]
                expr_stmt [2178,2205]
                    expr [2178,2204]
                        name [2178,2196]
                            name: r [2178,2179]
                            operator: -> [2179,2181]
                            name: param [2181,2186]
                            operator: . [2186,2187]
                            name: mount [2187,2192]
                            operator: . [2192,2193]
                            name: dev [2193,2196]
                        operator: = [2197,2198]
                        operator: & [2199,2200]
                        name: rdev [2200,2204]
                expr_stmt [2207,2234]
                    expr [2207,2233]
                        name [2207,2225]
                            name: r [2207,2208]
                            operator: -> [2208,2210]
                            name: param [2210,2215]
                            operator: . [2215,2216]
                            name: mount [2216,2221]
                            operator: . [2221,2222]
                            name: dir [2222,2225]
                        operator: = [2226,2227]
                        operator: & [2228,2229]
                        name: rdir [2229,2233]
                expr_stmt [2236,2265]
                    expr [2236,2264]
                        name [2236,2255]
                            name: r [2236,2237]
                            operator: -> [2237,2239]
                            name: param [2239,2244]
                            operator: . [2244,2245]
                            name: mount [2245,2250]
                            operator: . [2250,2251]
                            name: type [2251,2255]
                        operator: = [2256,2257]
                        operator: & [2258,2259]
                        name: rtype [2259,2264]
                expr_stmt [2267,2296]
                    expr [2267,2295]
                        name [2267,2287]
                            name: r [2267,2268]
                            operator: -> [2268,2270]
                            name: param [2270,2275]
                            operator: . [2275,2276]
                            name: mount [2276,2281]
                            operator: . [2281,2282]
                            name: flags [2282,2287]
                        operator: = [2288,2289]
                        name: flags [2290,2295]
                do [2298,2428]
                    block [2301,2389]
                        block_content [2305,2386]
                            expr_stmt [2305,2349]
                                expr [2305,2348]
                                    call [2305,2348]
                                        name: tomoyo_check_acl [2305,2321]
                                        argument_list [2321,2348]
                                            argument [2322,2323]
                                                expr [2322,2323]
                                                    name: r [2322,2323]
                                            argument [2325,2347]
                                                expr [2325,2347]
                                                    name: tomoyo_check_mount_acl [2325,2347]
                            expr_stmt [2352,2386]
                                expr [2352,2385]
                                    name: error [2352,2357]
                                    operator: = [2358,2359]
                                    call [2360,2385]
                                        name: tomoyo_audit_mount_log [2360,2382]
                                        argument_list [2382,2385]
                                            argument [2383,2384]
                                                expr [2383,2384]
                                                    name: r [2383,2384]
                    condition [2396,2427]
                        expr [2397,2426]
                            name: error [2397,2402]
                            operator: == [2403,2405]
                            name: TOMOYO_RETRY_REQUEST [2406,2426]
                label [2430,2434]
                    name: out [2430,2433]
                expr_stmt [2436,2462]
                    expr [2436,2461]
                        call [2436,2461]
                            name: kfree [2436,2441]
                            argument_list [2441,2461]
                                argument [2442,2460]
                                    expr [2442,2460]
                                        name: requested_dev_name [2442,2460]
                expr_stmt [2464,2490]
                    expr [2464,2489]
                        call [2464,2489]
                            name: kfree [2464,2469]
                            argument_list [2469,2489]
                                argument [2470,2488]
                                    expr [2470,2488]
                                        name: requested_dir_name [2470,2488]
                if_stmt [2492,2529]
                    if [2492,2529]
                        condition [2495,2503]
                            expr [2496,2502]
                                name: fstype [2496,2502]
                        block [2506,2529]
                            block_content [2506,2529]
                                expr_stmt [2506,2529]
                                    expr [2506,2528]
                                        call [2506,2528]
                                            name: put_filesystem [2506,2520]
                                            argument_list [2520,2528]
                                                argument [2521,2527]
                                                    expr [2521,2527]
                                                        name: fstype [2521,2527]
                expr_stmt [2531,2553]
                    expr [2531,2552]
                        call [2531,2552]
                            name: kfree [2531,2536]
                            argument_list [2536,2552]
                                argument [2537,2551]
                                    expr [2537,2551]
                                        name: requested_type [2537,2551]
                return [2555,2568]
                    expr [2562,2567]
                        name: error [2562,2567]